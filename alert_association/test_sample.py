import pandas as pd
import numpy as np

# Intra night association testing

# intra_night_separation_association testing

intra_sep_left_expected = pd.DataFrame(
    {
        "ra": [
            100.000,
            100.000,
            100.003,
            100.003,
            100.007,
            100.007,
            14.000,
            14.000,
            14.003,
            14.003,
            14.007,
            14.007,
        ],
        "dec": [
            8.000,
            8.000,
            8.002,
            8.002,
            8.005,
            8.005,
            16.000,
            16.000,
            15.998,
            15.998,
            15.992,
            15.992,
        ],
        "candid": [1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6],
        "traj": [1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2],
    }
)

intra_sep_right_expected = pd.DataFrame(
    {
        "ra": [
            100.003,
            100.007,
            100.000,
            100.007,
            100.000,
            100.003,
            14.003,
            14.007,
            14.000,
            14.007,
            14.000,
            14.003,
        ],
        "dec": [
            8.002,
            8.005,
            8.000,
            8.005,
            8.000,
            8.002,
            15.998,
            15.992,
            16.000,
            15.992,
            16.000,
            15.998,
        ],
        "candid": [2, 3, 1, 3, 1, 2, 5, 6, 4, 6, 4, 5],
        "traj": [1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2],
    }
)

# compute_diff_mag testing

same_fid_left_expected1 = pd.DataFrame(
    {
        "ra": [
            100.000,
            100.000,
            100.003,
            100.003,
            100.007,
            100.007,
            100.001,
            100.001,
            100.003,
            100.003,
            100.008,
            100.008,
        ],
        "dec": [
            12.000,
            12.000,
            11.998,
            11.998,
            11.994,
            11.994,
            11.994,
            11.994,
            11.998,
            11.998,
            12.002,
            12.002,
        ],
        "jd": [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
        "dcmag": [
            17.00,
            17.00,
            17.05,
            17.05,
            17.09,
            17.09,
            15.00,
            15.00,
            15.07,
            15.07,
            15.10,
            15.10,
        ],
        "fid": [1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2],
        "candid": [1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6],
        "traj": [1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2],
    }
)


same_fid_right_expected1 = pd.DataFrame(
    {
        "ra": [
            100.003,
            100.007,
            100.000,
            100.007,
            100.000,
            100.003,
            100.003,
            100.008,
            100.001,
            100.008,
            100.001,
            100.003,
        ],
        "dec": [
            11.998,
            11.994,
            12.000,
            11.994,
            12.000,
            11.998,
            11.998,
            12.002,
            11.994,
            12.002,
            11.994,
            11.998,
        ],
        "jd": [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
        "dcmag": [
            17.05,
            17.09,
            17.00,
            17.09,
            17.00,
            17.05,
            15.07,
            15.10,
            15.00,
            15.10,
            15.00,
            15.07,
        ],
        "fid": [1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2],
        "candid": [2, 3, 1, 3, 1, 2, 5, 6, 4, 6, 4, 5],
        "traj": [1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2],
    }
)


same_fid_left_expected2 = pd.DataFrame(
    {
        "ra": [100.0, 99.0, 99.8, 100.2, 100.7, 100.5],
        "dec": [12.0, 11.8, 11.2, 12.3, 11.7, 11.5],
        "jd": [1.05, 1.08, 1.09, 2.50, 2.60, 2.70],
        "dcmag": [15.00, 17.00, 16.00, 16.04, 17.03, 15.06],
        "fid": [1, 1, 1, 1, 1, 1],
        "candid": [1, 2, 3, 4, 5, 6],
        "traj": [1, 2, 3, 3, 2, 1],
    }
)


same_fid_right_expected2 = pd.DataFrame(
    {
        "ra": [100.5, 100.7, 100.2, 99.8, 99.0, 100.0],
        "dec": [11.5, 11.7, 12.3, 11.2, 11.8, 12.0],
        "jd": [2.70, 2.60, 2.50, 1.09, 1.08, 1.05],
        "dcmag": [15.06, 17.03, 16.04, 16.00, 17.00, 15.00],
        "fid": [1, 1, 1, 1, 1, 1],
        "candid": [6, 5, 4, 3, 2, 1],
        "traj": [1, 2, 3, 3, 2, 1],
    }
)


# intra_night_association testing

intra_night_test_traj = pd.DataFrame(
    {
        "ra": [
            106.305259,
            106.141905,
            169.860467,
            106.303285,
            106.141138,
            169.856885,
            106.140906,
            106.302386,
            106.140840,
            106.302364,
            169.833666,
            169.829712,
            169.829656,
        ],
        "dec": [
            18.176682,
            15.241181,
            15.206360,
            18.177874,
            15.239999,
            15.210309,
            15.239506,
            18.178404,
            15.239482,
            18.178424,
            15.236048,
            15.240389,
            15.240490,
        ],
        "dcmag": [
            0.066603,
            0.018517,
            0.038709,
            0.089385,
            0.020256,
            0.044030,
            0.021575,
            0.042095,
            0.023033,
            0.046602,
            0.032183,
            0.026171,
            0.025890,
        ],
        "ssnamenr": [
            3866,
            3051,
            19743,
            3866,
            3051,
            19743,
            3051,
            3866,
            3051,
            3866,
            19743,
            19743,
            19743,
        ],
        "fid": [1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2],
        "candid": [
            1520166712915015010,
            1520166711415015012,
            1520220641415015001,
            1520227401615015011,
            1520227400315015018,
            1520239140315015026,
            1520254695615015016,
            1520255162915015021,
            1520255630315015010,
            1520255631615015014,
            1520359440315015016,
            1520379906015015006,
            1520380381415015018,
        ],
        "jd": [
            2459274.666713,
            2459274.666713,
            2459274.7206481,
            2459274.7274074,
            2459274.7274074,
            2459274.7391435,
            2459274.7546991,
            2459274.755162,
            2459274.7556366,
            2459274.7556366,
            2459274.8594444,
            2459274.8799074,
            2459274.8803819,
        ],
    }
)

intra_night_left = pd.DataFrame(
    {
        "ra": [
            106.140906,
            106.302386,
            169.829712,
            106.141905,
            106.305259,
            169.860467,
            106.141138,
            106.303285,
            169.856885,
            169.833666,
        ],
        "dec": [
            15.239506,
            18.178404,
            15.240389,
            15.241181,
            18.176682,
            15.20636,
            15.239999,
            18.177874,
            15.210309,
            15.236048,
        ],
        "dcmag": [
            0.021575,
            0.042095,
            0.026171,
            0.018517,
            0.066603,
            0.038709,
            0.020256,
            0.089385,
            0.04403,
            0.032183,
        ],
        "ssnamenr": [3051, 3866, 19743, 3051, 3866, 19743, 3051, 3866, 19743, 19743],
        "fid": [2, 2, 2, 1, 1, 1, 1, 1, 1, 2],
        "candid": [
            1520254695615015016,
            1520255162915015021,
            1520379906015015006,
            1520166711415015012,
            1520166712915015010,
            1520220641415015001,
            1520227400315015018,
            1520227401615015011,
            1520239140315015026,
            1520359440315015016,
        ],
        "jd": [
            2459274.754699,
            2459274.755162,
            2459274.879907,
            2459274.666713,
            2459274.666713,
            2459274.720648,
            2459274.727407,
            2459274.727407,
            2459274.739144,
            2459274.859444,
        ],
    }
)

intra_night_right = pd.DataFrame(
    {
        "ra": [
            106.14084,
            106.302364,
            169.829656,
            106.141138,
            106.303285,
            169.856885,
            106.140906,
            106.302386,
            169.833666,
            169.829712,
        ],
        "dec": [
            15.239482,
            18.178424,
            15.24049,
            15.239999,
            18.177874,
            15.210309,
            15.239506,
            18.178404,
            15.236048,
            15.240389,
        ],
        "dcmag": [
            0.023033,
            0.046602,
            0.02589,
            0.020256,
            0.089385,
            0.04403,
            0.021575,
            0.042095,
            0.032183,
            0.026171,
        ],
        "ssnamenr": [3051, 3866, 19743, 3051, 3866, 19743, 3051, 3866, 19743, 19743],
        "fid": [2, 2, 2, 1, 1, 1, 2, 2, 2, 2],
        "candid": [
            1520255630315015010,
            1520255631615015014,
            1520380381415015018,
            1520227400315015018,
            1520227401615015011,
            1520239140315015026,
            1520254695615015016,
            1520255162915015021,
            1520359440315015016,
            1520379906015015006,
        ],
        "jd": [
            2459274.755637,
            2459274.755637,
            2459274.880382,
            2459274.727407,
            2459274.727407,
            2459274.739144,
            2459274.754699,
            2459274.755162,
            2459274.859444,
            2459274.879907,
        ],
    }
)


# Night to night association testing

# Cone search association testing

# Association that match the angle criterion
cone_search_two_last_observation_sample = pd.DataFrame(
    {
        "ra": [1, 2, 4, 5, 5, 6, 1, 2],
        "dec": [8, 7, 1, 2, 4, 8, 1, 1],
        "jd": [1, 2, 1, 2, 1, 2, 1, 2],
        "candid": [10, 11, 12, 13, 14, 15, 16, 17],
        "trajectory_id": [20, 20, 21, 21, 22, 22, 23, 23],
    }
)

traj_assoc_sample = pd.DataFrame(
    {
        "ra": [2, 5, 6, 2],
        "dec": [7, 2, 8, 1],
        "jd": [2, 2, 2, 2],
        "candid": [11, 13, 15, 17],
        "trajectory_id": [20, 21, 22, 23],
    }
)

new_obs_assoc_sample = pd.DataFrame(
    {
        "ra": [3, 6, 7, 3],
        "dec": [6, 3, 9, 1],
        "jd": [3, 3, 3, 3],
        "candid": [18, 19, 20, 21],
        "trajectory_id": [30, 31, 32, 33],
    }
)

left_cone_search_expected = pd.DataFrame(
    {
        "ra": [2, 5, 6, 2],
        "dec": [7, 2, 8, 1],
        "jd": [2, 2, 2, 2],
        "candid": [11, 13, 15, 17],
        "trajectory_id": [20, 21, 22, 23],
    }
)

right_cone_search_expected = pd.DataFrame(
    {
        "ra": [3, 6, 7, 3],
        "dec": [6, 3, 9, 1],
        "jd": [3, 3, 3, 3],
        "candid": [18, 19, 20, 21],
        "tmp_traj": [30, 31, 32, 33],
        "trajectory_id": [20, 21, 22, 23],
    }
)

# Association that not match the angle criterion
false_cone_search_two_last_observation_sample = pd.DataFrame(
    {
        "ra": [2, 3, 8, 9, 7, 8],
        "dec": [1, 2, 2, 3, 5, 6],
        "jd": [1, 2, 1, 2, 1, 2],
        "candid": [10, 11, 12, 13, 14, 15],
        "trajectory_id": [20, 20, 21, 21, 22, 22],
    }
)

false_traj_assoc_sample = pd.DataFrame(
    {
        "ra": [3, 9, 8],
        "dec": [2, 3, 6],
        "jd": [2, 2, 2],
        "candid": [11, 13, 15],
        "trajectory_id": [20, 21, 22],
    }
)

false_new_obs_assoc_sample = pd.DataFrame(
    {
        "ra": [4, 8, 7],
        "dec": [1, 5, 7],
        "jd": [3, 3, 3],
        "candid": [16, 17, 18],
        "trajectory_id": [30, 31, 32],
    }
)

# Night to night trajectory association testing

night_to_night_two_last_sample = pd.DataFrame(
    {
        "ra": [1, 2, 5, 6, 10, 11, 1, 2, 7, 7, 1, 8],
        "dec": [1, 2, 1, 1, 1, 1, 6, 7, 7, 8, 11, 6],
        "dcmag": [13, 13.05, 15, 15.08, 17, 17.03, 16, 16.04, 17, 17.1, 14, 18],
        "fid": [1, 2, 1, 1, 2, 2, 1, 2, 2, 2, 1, 1],
        "jd": [1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2],
        "candid": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21],
        "trajectory_id": [0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5],
    }
)

night_to_night_new_observation = pd.DataFrame(
    {
        "ra": [3, 7, 10.5, 2, 3, 4, 11, 8],
        "dec": [3, 2, 2, 8, 7, 9, 9, 9],
        "dcmag": [13.1, 15.13, 17.06, 16.07, 16.05, 15, 18, 18.5],
        "fid": [2, 1, 1, 1, 2, 1, 2, 2],
        "jd": [3, 3, 3, 3, 3, 3, 3, 3],
        "candid": [22, 23, 24, 25, 26, 27, 28, 29],
    }
)

night_to_night_traj_assoc_left_expected = pd.DataFrame(
    {
        "trajectory_id": [0, 1, 3, 3],
        "ra": [2, 6, 2, 2],
        "dec": [2, 1, 7, 7],
        "dcmag": [13.05, 15.08, 16.04, 16.04],
        "fid": [2, 1, 2, 2],
        "jd": [2, 2, 2, 2],
        "candid": [11, 13, 17, 17],
    }
)

night_to_night_traj_assoc_right_expected = pd.DataFrame(
    {
        "ra": [3.0, 7, 3, 2],
        "dec": [3, 2, 7, 8],
        "dcmag": [13.10, 15.13, 16.05, 16.07],
        "fid": [2, 1, 2, 1],
        "jd": [3, 3, 3, 3],
        "candid": [22, 23, 26, 25],
        "trajectory_id": [0, 1, 3, 3],
    }
)


# trajectory associations testing

trajectory_df_sample = pd.DataFrame(
    {
        "ra": [1, 2, 3, 1, 2, 2, 6, 7, 8, 6, 7, 8, 9, 10, 10],
        "dec": [1, 2, 3, 12, 11, 10, 12, 12, 12, 6, 5, 6, 1, 2, 3],
        "dcmag": [
            12.02,
            12.05,
            12.3,
            15,
            15.1,
            15.23,
            13,
            12.6,
            12.75,
            17.02,
            17.15,
            17.27,
            16,
            16.4,
            16.7,
        ],
        "fid": [1, 1, 2, 1, 1, 1, 1, 2, 2, 2, 2, 2, 1, 2, 1],
        "nid": [1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3],
        "jd": [1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3],
        "candid": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24],
        "trajectory_id": [1, 1, 1, 2, 2, 2, 3, 3, 3, 4, 4, 4, 5, 5, 5],
    }
)

traj_next_night_sample = pd.DataFrame(
    {
        "ra": [4, 5, 1, 1, 8, 7, 13, 13],
        "dec": [4, 5, 9, 8, 7, 8, 1, 2],
        "dcmag": [12.4, 12.52, 15.94, 15.47, 17.31, 17.43, 16.21, 16.28],
        "fid": [1, 1, 2, 1, 1, 1, 2, 2],
        "nid": [4, 4, 4, 4, 4, 4, 4, 4],
        "jd": [4.1, 4.2, 4.1, 4.2, 4.1, 4.2, 4.1, 4.2],
        "candid": [25, 26, 27, 28, 29, 30, 31, 32],
        "trajectory_id": [10, 10, 11, 11, 12, 12, 13, 13],
    }
)

new_observations_sample = pd.DataFrame(
    {
        "ra": [5, 5, 10, 9, 13],
        "dec": [1, 10, 4, 10, 11],
        "dcmag": [13.42, 17.5, 16.82, 15.86, 16.49],
        "fid": [2, 2, 1, 2, 1],
        "nid": [4, 4, 4, 4, 4],
        "jd": [4.1, 4.2, 4.2, 4.2, 4.3],
        "candid": [33, 34, 35, 36, 37],
    }
)

trajectory_df_expected = pd.DataFrame(
    {
        "ra": [1, 2, 3, 1, 2, 2, 6, 7, 8, 6, 7, 8, 9, 10, 10, 4, 5, 8, 7, 10],
        "dec": [1, 2, 3, 12, 11, 10, 12, 12, 12, 6, 5, 6, 1, 2, 3, 4, 5, 7, 8, 4],
        "dcmag": [
            12.02,
            12.05,
            12.30,
            15.00,
            15.10,
            15.23,
            13.00,
            12.60,
            12.75,
            17.02,
            17.15,
            17.27,
            16.00,
            16.40,
            16.70,
            12.40,
            12.52,
            17.31,
            17.43,
            16.82,
        ],
        "fid": [1, 1, 2, 1, 1, 1, 1, 2, 2, 2, 2, 2, 1, 2, 1, 1, 1, 1, 1, 1],
        "nid": [1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 4, 4, 4, 4, 4],
        "jd": [
            1.0,
            2.0,
            3.0,
            1.0,
            2.0,
            3.0,
            1.0,
            2.0,
            3.0,
            1.0,
            2.0,
            3.0,
            1.0,
            2.0,
            3.0,
            4.1,
            4.2,
            4.1,
            4.2,
            4.2,
        ],
        "candid": [
            10,
            11,
            12,
            13,
            14,
            15,
            16,
            17,
            18,
            19,
            20,
            21,
            22,
            23,
            24,
            25,
            26,
            29,
            30,
            35,
        ],
        "trajectory_id": [
            1.0,
            1.0,
            1.0,
            2.0,
            2.0,
            2.0,
            3.0,
            3.0,
            3.0,
            4.0,
            4.0,
            4.0,
            5.0,
            5.0,
            5.0,
            1.0,
            1.0,
            4.0,
            4.0,
            5.0,
        ],
    }
)

traj_next_night_expected = pd.DataFrame(
    {
        "ra": [1, 1, 13, 13],
        "dec": [9, 8, 1, 2],
        "dcmag": [15.94, 15.47, 16.21, 16.28],
        "fid": [2, 1, 2, 2],
        "nid": [4, 4, 4, 4],
        "jd": [4.1, 4.2, 4.1, 4.2],
        "candid": [27, 28, 31, 32],
        "trajectory_id": [11, 11, 13, 13],
    }
)

new_observations_expected = pd.DataFrame(
    {
        "ra": [5, 5, 9, 13],
        "dec": [1, 10, 10, 11],
        "dcmag": [13.42, 17.50, 15.86, 16.49],
        "fid": [2, 2, 2, 1],
        "nid": [4, 4, 4, 4],
        "jd": [4.1, 4.2, 4.2, 4.3],
        "candid": [33, 34, 36, 37],
    }
)

trajectory_df_expected2 = pd.DataFrame(
    {
        "ra": [1, 2, 3, 1, 2, 2, 6, 7, 8, 6, 7, 8, 9, 10, 10, 4, 5, 8, 7],
        "dec": [1, 2, 3, 12, 11, 10, 12, 12, 12, 6, 5, 6, 1, 2, 3, 4, 5, 7, 8],
        "dcmag": [
            12.02,
            12.05,
            12.30,
            15.00,
            15.10,
            15.23,
            13.00,
            12.60,
            12.75,
            17.02,
            17.15,
            17.27,
            16.00,
            16.40,
            16.70,
            12.40,
            12.52,
            17.31,
            17.43,
        ],
        "fid": [1, 1, 2, 1, 1, 1, 1, 2, 2, 2, 2, 2, 1, 2, 1, 1, 1, 1, 1],
        "nid": [1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 4, 4, 4, 4],
        "jd": [
            1.0,
            2.0,
            3.0,
            1.0,
            2.0,
            3.0,
            1.0,
            2.0,
            3.0,
            1.0,
            2.0,
            3.0,
            1.0,
            2.0,
            3.0,
            4.1,
            4.2,
            4.1,
            4.2,
        ],
        "candid": [
            10,
            11,
            12,
            13,
            14,
            15,
            16,
            17,
            18,
            19,
            20,
            21,
            22,
            23,
            24,
            25,
            26,
            29,
            30,
        ],
        "trajectory_id": [
            1.0,
            1.0,
            1.0,
            2.0,
            2.0,
            2.0,
            3.0,
            3.0,
            3.0,
            4.0,
            4.0,
            4.0,
            5.0,
            5.0,
            5.0,
            1.0,
            1.0,
            4.0,
            4.0,
        ],
    }
)

trajectory_df_expected_empty = pd.DataFrame(
    {
        "ra": [1, 2, 3, 1, 2, 2, 6, 7, 8, 6, 7, 8, 9, 10, 10, 10],
        "dec": [1, 2, 3, 12, 11, 10, 12, 12, 12, 6, 5, 6, 1, 2, 3, 4],
        "dcmag": [
            12.02,
            12.05,
            12.30,
            15.00,
            15.10,
            15.23,
            13.00,
            12.60,
            12.75,
            17.02,
            17.15,
            17.27,
            16.00,
            16.40,
            16.70,
            16.82,
        ],
        "fid": [1, 1, 2, 1, 1, 1, 1, 2, 2, 2, 2, 2, 1, 2, 1, 1],
        "nid": [1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 4],
        "jd": [
            1.0,
            2.0,
            3.0,
            1.0,
            2.0,
            3.0,
            1.0,
            2.0,
            3.0,
            1.0,
            2.0,
            3.0,
            1.0,
            2.0,
            3.0,
            4.2,
        ],
        "candid": [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 35],
        "trajectory_id": [1, 1, 1, 2, 2, 2, 3, 3, 3, 4, 4, 4, 5, 5, 5, 5],
    }
)

expected_trajectory_first_report = {
    "list of updated trajectories": [1.0, 4.0, 5.0],
    "all nid report": [
        {
            "old nid": 3,
            "trajectories_to_tracklets_report": {
                "number of inter night separation based association": 3,
                "number of inter night magnitude filtered association": 1,
                "number of inter night angle filtered association": 0,
                "number of duplicated association": 0,
                "metrics": {},
            },
            "trajectories_to_new_observation_report": {
                "number of inter night separation based association": 1,
                "number of inter night magnitude filtered association": 0,
                "number of inter night angle filtered association": 0,
                "number of duplicated association": 0,
                "metrics": {},
            },
        }
    ],
}


expected_trajectory_second_report = {
    "list of updated trajectories": [5.0],
    "all nid report": [
        {
            "old nid": 3,
            "trajectories_to_tracklets_report": {
                "number of inter night separation based association": 0,
                "number of inter night magnitude filtered association": 0,
                "number of inter night angle filtered association": 0,
                "number of duplicated association": 0,
                "metrics": {},
            },
            "trajectories_to_new_observation_report": {
                "number of inter night separation based association": 1,
                "number of inter night magnitude filtered association": 0,
                "number of inter night angle filtered association": 0,
                "number of duplicated association": 0,
                "metrics": {},
            },
        }
    ],
}

expected_trajectory_third_report = {
    "list of updated trajectories": [],
    "all nid report": [
        {
            "old nid": 3,
            "trajectories_to_tracklets_report": {
                "number of inter night separation based association": 3,
                "number of inter night magnitude filtered association": 1,
                "number of inter night angle filtered association": 0,
                "number of duplicated association": 0,
                "metrics": {},
            },
            "trajectories_to_new_observation_report": {},
        }
    ],
}

# tracklets and observations associations testing

track_and_obs_trajectory_df_sample = pd.DataFrame(
    {
        "ra": [1, 2, 2, 6, 7, 8, 6, 7, 8, 9, 10, 10],
        "dec": [12, 11, 10, 12, 12, 12, 6, 5, 6, 1, 2, 3],
        "dcmag": [
            15,
            15.1,
            15.23,
            13,
            12.6,
            12.75,
            17.02,
            17.15,
            17.27,
            16,
            16.4,
            16.7,
        ],
        "fid": [1, 1, 1, 1, 2, 2, 2, 2, 2, 1, 2, 1],
        "nid": [1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3],
        "jd": [1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3],
        "candid": [13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24],
        "trajectory_id": [2, 2, 2, 3, 3, 3, 4, 4, 4, 5, 5, 5],
    }
)

track_and_obs_traj_next_night_sample = pd.DataFrame(
    {
        "ra": [2, 3, 7, 8],
        "dec": [2, 3, 1, 2],
        "dcmag": [15.74, 15.47, 16.21, 16.28],
        "fid": [2, 1, 2, 2],
        "nid": [4, 4, 4, 4],
        "jd": [4.1, 4.2, 4.1, 4.2],
        "candid": [27, 28, 31, 32],
        "trajectory_id": [11, 11, 13, 13],
    }
)

track_and_obs_old_observations_sample = pd.DataFrame(
    {
        "ra": [1, 1, 4, 3, 6, 7, 9],
        "dec": [1, 5, 1, 5, 1, 7, 5],
        "dcmag": [15.52, 16.32, 14.96, 16.28, 16.03, 18.52, 17.68],
        "fid": [2, 1, 2, 2, 2, 1, 1],
        "nid": [2, 1, 3, 3, 3, 3, 3],
        "jd": [2.1, 1.2, 3.1, 3.2, 3.1, 3.2, 3.1],
        "candid": [33, 34, 35, 36, 37, 38, 39],
    }
)

track_and_obs_new_observations_sample = pd.DataFrame(
    {
        "ra": [2, 4, 6, 5, 10],
        "dec": [9, 6, 3, 10, 4],
        "dcmag": [15.52, 16.32, 14.96, 18.52, 17.99],
        "fid": [2, 1, 2, 1, 2],
        "nid": [4, 4, 4, 4, 4],
        "jd": [4.1, 4.2, 4.1, 4.2, 4.1],
        "candid": [40, 41, 42, 43, 44],
    }
)

track_and_obs_trajectory_df_expected = pd.DataFrame(
    {
        "ra": [
            1,
            2,
            2,
            6,
            7,
            8,
            6,
            7,
            8,
            9,
            10,
            10,
            3,
            9,
            4,
            10,
            1,
            2,
            2,
            3,
            7,
            8,
            6,
            1,
        ],
        "dec": [
            12,
            11,
            10,
            12,
            12,
            12,
            6,
            5,
            6,
            1,
            2,
            3,
            5,
            5,
            6,
            4,
            5,
            9,
            2,
            3,
            1,
            2,
            1,
            1,
        ],
        "dcmag": [
            15.00,
            15.10,
            15.23,
            13.00,
            12.60,
            12.75,
            17.02,
            17.15,
            17.27,
            16.00,
            16.40,
            16.70,
            16.28,
            17.68,
            16.32,
            17.99,
            16.32,
            15.52,
            15.74,
            15.47,
            16.21,
            16.28,
            16.03,
            15.52,
        ],
        "fid": [1, 1, 1, 1, 2, 2, 2, 2, 2, 1, 2, 1, 2, 1, 1, 2, 1, 2, 2, 1, 2, 2, 2, 2],
        "nid": [1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 3, 3, 4, 4, 1, 4, 4, 4, 4, 4, 3, 2],
        "jd": [
            1.0,
            2.0,
            3.0,
            1.0,
            2.0,
            3.0,
            1.0,
            2.0,
            3.0,
            1.0,
            2.0,
            3.0,
            3.2,
            3.1,
            4.2,
            4.1,
            1.2,
            4.1,
            4.1,
            4.2,
            4.1,
            4.2,
            3.1,
            2.1,
        ],
        "candid": [
            13,
            14,
            15,
            16,
            17,
            18,
            19,
            20,
            21,
            22,
            23,
            24,
            36,
            39,
            41,
            44,
            34,
            40,
            27,
            28,
            31,
            32,
            37,
            33,
        ],
        "trajectory_id": [
            2,
            2,
            2,
            3,
            3,
            3,
            4,
            4,
            4,
            5,
            5,
            5,
            6,
            7,
            6,
            7,
            8,
            8,
            11,
            11,
            13,
            13,
            13,
            11,
        ],
    }
)

track_and_obs_old_observations_expected = pd.DataFrame(
    {
        "ra": [4, 7, 6, 5],
        "dec": [1, 7, 3, 10],
        "dcmag": [14.96, 18.52, 14.96, 18.52],
        "fid": [2, 1, 2, 1],
        "nid": [3, 3, 4, 4],
        "jd": [3.1, 3.2, 4.1, 4.2],
        "candid": [35, 38, 42, 43],
    }
)


track_and_obs_trajectory_df_expected2 = pd.DataFrame(
    {
        "ra": [1, 2, 2, 6, 7, 8, 6, 7, 8, 9, 10, 10, 3, 9, 4, 10, 1, 2],
        "dec": [12, 11, 10, 12, 12, 12, 6, 5, 6, 1, 2, 3, 5, 5, 6, 4, 5, 9],
        "dcmag": [
            15,
            15.1,
            15.23,
            13,
            12.6,
            12.75,
            17.02,
            17.15,
            17.27,
            16,
            16.4,
            16.7,
            16.28,
            17.68,
            16.32,
            17.99,
            16.32,
            15.52,
        ],
        "fid": [1, 1, 1, 1, 2, 2, 2, 2, 2, 1, 2, 1, 2, 1, 1, 2, 1, 2],
        "nid": [1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 3, 3, 4, 4, 1, 4],
        "jd": [1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 3.2, 3.1, 4.2, 4.1, 1.2, 4.1],
        "candid": [
            13,
            14,
            15,
            16,
            17,
            18,
            19,
            20,
            21,
            22,
            23,
            24,
            36,
            39,
            41,
            44,
            34,
            40,
        ],
        "trajectory_id": [2, 2, 2, 3, 3, 3, 4, 4, 4, 5, 5, 5, 6, 7, 6, 7, 8, 8],
    }
)

track_and_obs_old_observations_expected2 = pd.DataFrame(
    {
        "ra": [1, 4, 6, 7, 6, 5],
        "dec": [1, 1, 1, 7, 3, 10],
        "dcmag": [15.52, 14.96, 16.03, 18.52, 14.96, 18.52],
        "fid": [2, 2, 2, 1, 2, 1],
        "nid": [2, 3, 3, 3, 4, 4],
        "jd": [2.1, 3.1, 3.1, 3.2, 4.1, 4.2],
        "candid": [33, 35, 37, 38, 42, 43],
    }
)

track_and_obs_trajectory_df_expected3 = pd.DataFrame(
    {
        "ra": [3, 9, 4, 10, 1, 2, 2, 3, 7, 8, 6, 1],
        "dec": [5, 5, 6, 4, 5, 9, 2, 3, 1, 2, 1, 1],
        "dcmag": [
            16.28,
            17.68,
            16.32,
            17.99,
            16.32,
            15.52,
            15.74,
            15.47,
            16.21,
            16.28,
            16.03,
            15.52,
        ],
        "fid": [2, 1, 1, 2, 1, 2, 2, 1, 2, 2, 2, 2],
        "nid": [3, 3, 4, 4, 1, 4, 4, 4, 4, 4, 3, 2],
        "jd": [3.2, 3.1, 4.2, 4.1, 1.2, 4.1, 4.1, 4.2, 4.1, 4.2, 3.1, 2.1],
        "candid": [36, 39, 41, 44, 34, 40, 27, 28, 31, 32, 37, 33],
        "trajectory_id": [6, 7, 6, 7, 8, 8, 11, 11, 13, 13, 13, 11],
    }
)

track_and_obs_trajectory_df_expected4 = pd.DataFrame(
    {
        "ra": [1, 2, 2, 6, 7, 8, 6, 7, 8, 9, 10, 10, 2, 3, 7, 8],
        "dec": [12, 11, 10, 12, 12, 12, 6, 5, 6, 1, 2, 3, 2, 3, 1, 2],
        "dcmag": [
            15,
            15.1,
            15.23,
            13,
            12.6,
            12.75,
            17.02,
            17.15,
            17.27,
            16,
            16.4,
            16.7,
            15.74,
            15.47,
            16.21,
            16.28,
        ],
        "fid": [1, 1, 1, 1, 2, 2, 2, 2, 2, 1, 2, 1, 2, 1, 2, 2],
        "nid": [1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 4, 4, 4, 4],
        "jd": [1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 4.1, 4.2, 4.1, 4.2],
        "candid": [13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 27, 28, 31, 32],
        "trajectory_id": [2, 2, 2, 3, 3, 3, 4, 4, 4, 5, 5, 5, 11, 11, 13, 13],
    }
)

track_and_obs_old_observations_expected3 = pd.DataFrame(
    {
        "ra": [2, 4, 6, 5, 10],
        "dec": [9, 6, 3, 10, 4],
        "dcmag": [15.52, 16.32, 14.96, 18.52, 17.99],
        "fid": [2, 1, 2, 1, 2],
        "nid": [4, 4, 4, 4, 4],
        "jd": [4.1, 4.2, 4.1, 4.2, 4.1],
        "candid": [40, 41, 42, 43, 44],
    }
)

track_and_obs_trajectory_df_expected5 = pd.DataFrame(
    {
        "ra": [1, 2, 2, 6, 7, 8, 6, 7, 8, 9, 10, 10, 2, 3, 7, 8, 6, 1],
        "dec": [12, 11, 10, 12, 12, 12, 6, 5, 6, 1, 2, 3, 2, 3, 1, 2, 1, 1],
        "dcmag": [
            15,
            15.1,
            15.23,
            13,
            12.6,
            12.75,
            17.02,
            17.15,
            17.27,
            16,
            16.4,
            16.7,
            15.74,
            15.47,
            16.21,
            16.28,
            16.03,
            15.52,
        ],
        "fid": [1, 1, 1, 1, 2, 2, 2, 2, 2, 1, 2, 1, 2, 1, 2, 2, 2, 2],
        "nid": [1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 4, 4, 4, 4, 3, 2],
        "jd": [1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 4.1, 4.2, 4.1, 4.2, 3.1, 2.1],
        "candid": [
            13,
            14,
            15,
            16,
            17,
            18,
            19,
            20,
            21,
            22,
            23,
            24,
            27,
            28,
            31,
            32,
            37,
            33,
        ],
        "trajectory_id": [2, 2, 2, 3, 3, 3, 4, 4, 4, 5, 5, 5, 11, 11, 13, 13, 13, 11],
    }
)

track_and_obs_old_observations_expected4 = pd.DataFrame(
    {
        "ra": [1, 4, 3, 7, 9],
        "dec": [5, 1, 5, 7, 5],
        "dcmag": [16.32, 14.96, 16.28, 18.52, 17.68],
        "fid": [1, 2, 2, 1, 1],
        "nid": [1, 3, 3, 3, 3],
        "jd": [1.2, 3.1, 3.2, 3.2, 3.1],
        "candid": [34, 35, 36, 38, 39],
    }
)

expected_traj_obs_report = {
    "list of updated trajectories": [6.0, 7.0, 8.0, 11.0, 13.0],
    "all nid report": [
        {
            "old nid": 3,
            "old observation to tracklets report": {
                "number of inter night separation based association": 1,
                "number of inter night magnitude filtered association": 0,
                "number of inter night angle filtered association": 0,
                "number of duplicated association": 0,
                "metrics": {},
            },
            "old observation to new observation report": {
                "number of inter night separation based association": 2,
                "number of inter night magnitude filtered association": 0,
                "number of duplicated association": 0,
                "number of inter night angle filtered association": 0,
            },
        },
        {
            "old nid": 2,
            "old observation to tracklets report": {
                "number of inter night separation based association": 1,
                "number of inter night magnitude filtered association": 0,
                "number of inter night angle filtered association": 0,
                "number of duplicated association": 0,
                "metrics": {},
            },
            "old observation to new observation report": {
                "number of inter night separation based association": 0,
                "number of inter night magnitude filtered association": 0,
                "number of duplicated association": 0,
                "number of inter night angle filtered association": 0,
            },
        },
        {
            "old nid": 1,
            "old observation to tracklets report": {
                "number of inter night separation based association": 0,
                "number of inter night magnitude filtered association": 0,
                "number of inter night angle filtered association": 0,
                "number of duplicated association": 0,
                "metrics": {},
            },
            "old observation to new observation report": {
                "number of inter night separation based association": 1,
                "number of inter night magnitude filtered association": 0,
                "number of duplicated association": 0,
                "number of inter night angle filtered association": 0,
            },
        },
    ],
}

expected_traj_obs_report2 = {
    "list of updated trajectories": [6.0, 7.0, 8.0],
    "all nid report": [
        {
            "old nid": 3,
            "old observation to tracklets report": {
                "number of inter night separation based association": 0,
                "number of inter night magnitude filtered association": 0,
                "number of inter night angle filtered association": 0,
                "number of duplicated association": 0,
                "metrics": {},
            },
            "old observation to new observation report": {
                "number of inter night separation based association": 2,
                "number of inter night magnitude filtered association": 0,
                "number of duplicated association": 0,
                "number of inter night angle filtered association": 0,
            },
        },
        {
            "old nid": 2,
            "old observation to tracklets report": {
                "number of inter night separation based association": 0,
                "number of inter night magnitude filtered association": 0,
                "number of inter night angle filtered association": 0,
                "number of duplicated association": 0,
                "metrics": {},
            },
            "old observation to new observation report": {
                "number of inter night separation based association": 0,
                "number of inter night magnitude filtered association": 0,
                "number of duplicated association": 0,
                "number of inter night angle filtered association": 0,
            },
        },
        {
            "old nid": 1,
            "old observation to tracklets report": {
                "number of inter night separation based association": 0,
                "number of inter night magnitude filtered association": 0,
                "number of inter night angle filtered association": 0,
                "number of duplicated association": 0,
                "metrics": {},
            },
            "old observation to new observation report": {
                "number of inter night separation based association": 1,
                "number of inter night magnitude filtered association": 0,
                "number of duplicated association": 0,
                "number of inter night angle filtered association": 0,
            },
        },
    ],
}


expected_traj_obs_report3 = {
    "list of updated trajectories": [6.0, 7.0, 8.0, 11.0, 13.0],
    "all nid report": [
        {
            "old nid": 3,
            "old observation to tracklets report": {
                "number of inter night separation based association": 1,
                "number of inter night magnitude filtered association": 0,
                "number of inter night angle filtered association": 0,
                "number of duplicated association": 0,
                "metrics": {},
            },
            "old observation to new observation report": {
                "number of inter night separation based association": 2,
                "number of inter night magnitude filtered association": 0,
                "number of duplicated association": 0,
                "number of inter night angle filtered association": 0,
            },
        },
        {
            "old nid": 2,
            "old observation to tracklets report": {
                "number of inter night separation based association": 1,
                "number of inter night magnitude filtered association": 0,
                "number of inter night angle filtered association": 0,
                "number of duplicated association": 0,
                "metrics": {},
            },
            "old observation to new observation report": {
                "number of inter night separation based association": 0,
                "number of inter night magnitude filtered association": 0,
                "number of duplicated association": 0,
                "number of inter night angle filtered association": 0,
            },
        },
        {
            "old nid": 1,
            "old observation to tracklets report": {
                "number of inter night separation based association": 0,
                "number of inter night magnitude filtered association": 0,
                "number of inter night angle filtered association": 0,
                "number of duplicated association": 0,
                "metrics": {},
            },
            "old observation to new observation report": {
                "number of inter night separation based association": 1,
                "number of inter night magnitude filtered association": 0,
                "number of duplicated association": 0,
                "number of inter night angle filtered association": 0,
            },
        },
    ],
}

expected_traj_obs_report4 = {
    "list of updated trajectories": [11.0, 13.0],
    "all nid report": [
        {
            "old nid": 3,
            "old observation to tracklets report": {
                "number of inter night separation based association": 1,
                "number of inter night magnitude filtered association": 0,
                "number of inter night angle filtered association": 0,
                "number of duplicated association": 0,
                "metrics": {},
            },
            "old observation to new observation report": {
                "number of inter night separation based association": 0,
                "number of inter night magnitude filtered association": 0,
                "number of inter night angle filtered association": 0,
                "number of duplicated association": 0,
                "metrics": {},
            },
        },
        {
            "old nid": 2,
            "old observation to tracklets report": {
                "number of inter night separation based association": 1,
                "number of inter night magnitude filtered association": 0,
                "number of inter night angle filtered association": 0,
                "number of duplicated association": 0,
                "metrics": {},
            },
            "old observation to new observation report": {
                "number of inter night separation based association": 0,
                "number of inter night magnitude filtered association": 0,
                "number of inter night angle filtered association": 0,
                "number of duplicated association": 0,
                "metrics": {},
            },
        },
        {
            "old nid": 1,
            "old observation to tracklets report": {
                "number of inter night separation based association": 0,
                "number of inter night magnitude filtered association": 0,
                "number of inter night angle filtered association": 0,
                "number of duplicated association": 0,
                "metrics": {},
            },
            "old observation to new observation report": {
                "number of inter night separation based association": 0,
                "number of inter night magnitude filtered association": 0,
                "number of inter night angle filtered association": 0,
                "number of duplicated association": 0,
                "metrics": {},
            },
        },
    ],
}

# Night to night association testing

night_night_trajectory_sample = pd.DataFrame(
    {
        "ra": [1, 2, 3, 6, 7, 8, 11, 12, 13],
        "dec": [1, 2, 3, 1, 1, 2, 3, 4, 5],
        "dcmag": [12, 12.2, 12.4, 15, 15.4, 15.5, 13, 13.1, 13.2],
        "fid": [1, 1, 1, 1, 2, 2, 2, 2, 2],
        "nid": [1, 2, 3, 1, 2, 3, 1, 2, 3],
        "jd": [1, 2, 3, 1, 2, 3, 1, 2, 3],
        "candid": [10, 11, 12, 13, 14, 15, 16, 17, 18],
        "trajectory_id": [1, 1, 1, 2, 2, 2, 3, 3, 3],
    }
)

night_to_night_old_obs = pd.DataFrame(
    {
        "ra": [15, 7],
        "dec": [1, 7],
        "dcmag": [14, 16],
        "fid": [1, 2],
        "nid": [3, 2],
        "jd": [3, 2],
        "candid": [19, 29],
    }
)

night_to_night_new_obs = pd.DataFrame(
    {
        "ra": [4, 5, 1, 2, 12, 11, 16, 9, 17],
        "dec": [4, 5, 7, 8, 6, 7, 1, 3, 10],
        "dcmag": [12.5, 12.7, 17.2, 17.26, 13.32, 13.28, 14.12, 15.8, 15.21],
        "fid": [1, 1, 2, 2, 2, 2, 1, 1, 2],
        "nid": [4, 4, 4, 4, 4, 4, 4, 4, 4],
        "jd": [4.1, 4.2, 4.1, 4.2, 4.1, 4.2, 4.2, 4.1, 4.2],
        "candid": [20, 21, 22, 23, 24, 25, 26, 27, 28],
        "ssnamenr": [1, 1, 2, 2, 3, 3, 4, 5, 6],
    }
)


night_to_night_trajectory_df_expected = pd.DataFrame(
    {
        "ra": [1, 2, 3, 6, 7, 8, 11, 12, 13, 4, 5, 9, 15, 16, 1, 12, 2, 11],
        "dec": [1, 2, 3, 1, 1, 2, 3, 4, 5, 4, 5, 3, 1, 1, 7, 6, 8, 7],
        "dcmag": [
            12.00,
            12.20,
            12.40,
            15.00,
            15.40,
            15.50,
            13.00,
            13.10,
            13.20,
            12.50,
            12.70,
            15.80,
            14.00,
            14.12,
            17.20,
            13.32,
            17.26,
            13.28,
        ],
        "fid": [1, 1, 1, 1, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 2, 2, 2, 2],
        "nid": [1, 2, 3, 1, 2, 3, 1, 2, 3, 4, 4, 4, 3, 4, 4, 4, 4, 4],
        "jd": [
            1.0,
            2.0,
            3.0,
            1.0,
            2.0,
            3.0,
            1.0,
            2.0,
            3.0,
            4.1,
            4.2,
            4.1,
            3.0,
            4.2,
            4.1,
            4.1,
            4.2,
            4.2,
        ],
        "candid": [
            10,
            11,
            12,
            13,
            14,
            15,
            16,
            17,
            18,
            20,
            21,
            27,
            19,
            26,
            22,
            24,
            23,
            25,
        ],
        "trajectory_id": [1, 1, 1, 2, 2, 2, 3, 3, 3, 1, 1, 2, 7, 7, 5, 6, 5, 6],
        "ssnamenr": [
            np.nan,
            np.nan,
            np.nan,
            np.nan,
            np.nan,
            np.nan,
            np.nan,
            np.nan,
            np.nan,
            1,
            1,
            5,
            np.nan,
            4,
            2,
            3,
            2,
            3,
        ],
    }
)

night_to_night_old_observation_expected = pd.DataFrame(
    {
        "ra": [7, 17],
        "dec": [7, 10],
        "dcmag": [16.00, 15.21],
        "fid": [2, 2],
        "nid": [2, 4],
        "jd": [2.0, 4.2],
        "candid": [29, 28],
        "ssnamenr": [np.nan, 6.0],
    }
)


night_to_night_trajectory_df_expected2 = pd.DataFrame(
    {
        "ra": [15, 16, 4, 1, 12, 5, 2, 11],
        "dec": [1, 1, 4, 7, 6, 5, 8, 7],
        "dcmag": [14.00, 14.12, 12.50, 17.20, 13.32, 12.70, 17.26, 13.28],
        "fid": [1, 1, 1, 2, 2, 1, 2, 2],
        "nid": [3, 4, 4, 4, 4, 4, 4, 4],
        "jd": [3.0, 4.2, 4.1, 4.1, 4.1, 4.2, 4.2, 4.2],
        "candid": [19, 26, 20, 22, 24, 21, 23, 25],
        "trajectory_id": [7, 7, 4, 5, 6, 4, 5, 6],
        "ssnamenr": [np.nan, 4.0, 1, 2, 3, 1, 2, 3],
    }
)

night_to_night_old_observation_expected2 = pd.DataFrame(
    {
        "ra": [7, 9, 17],
        "dec": [7, 3, 10],
        "dcmag": [16.00, 15.80, 15.21],
        "fid": [2, 1, 2],
        "nid": [2, 4, 4],
        "jd": [2.0, 4.1, 4.2],
        "candid": [29, 27, 28],
        "ssnamenr": [np.nan, 5.0, 6.0],
    }
)


night_to_night_new_obs2 = pd.DataFrame(
    {
        "ra": [4, 5, 1, 2, 12, 11, 16, 9, 17],
        "dec": [4, 5, 7, 8, 6, 7, 1, 3, 10],
        "dcmag": [12.5, 17.7, 17.2, 13.26, 13.32, 18.28, 14.12, 15.8, 15.21],
        "fid": [1, 1, 2, 2, 2, 2, 1, 1, 2],
        "nid": [4, 4, 4, 4, 4, 4, 4, 4, 4],
        "jd": [4.1, 4.2, 4.1, 4.2, 4.1, 4.2, 4.2, 4.1, 4.2],
        "candid": [20, 21, 22, 23, 24, 25, 26, 27, 28],
    }
)


night_to_night_trajectory_df_expected3 = pd.DataFrame(
    {
        "ra": [
            1.0,
            2.0,
            3.0,
            6.0,
            7.0,
            8.0,
            11.0,
            12.0,
            13.0,
            4.0,
            9.0,
            15.0,
            16.0,
            7.0,
            5.0,
        ],
        "dec": [
            1.0,
            2.0,
            3.0,
            1.0,
            1.0,
            2.0,
            3.0,
            4.0,
            5.0,
            4.0,
            3.0,
            1.0,
            1.0,
            7.0,
            5.0,
        ],
        "dcmag": [
            12.00,
            12.20,
            12.40,
            15.00,
            15.40,
            15.50,
            13.00,
            13.10,
            13.20,
            12.50,
            15.80,
            14.00,
            14.12,
            16.00,
            17.70,
        ],
        "fid": [
            1.0,
            1.0,
            1.0,
            1.0,
            2.0,
            2.0,
            2.0,
            2.0,
            2.0,
            1.0,
            1.0,
            1.0,
            1.0,
            2.0,
            1.0,
        ],
        "nid": [
            1.0,
            2.0,
            3.0,
            1.0,
            2.0,
            3.0,
            1.0,
            2.0,
            3.0,
            4.0,
            4.0,
            3.0,
            4.0,
            2.0,
            4.0,
        ],
        "jd": [
            1.0,
            2.0,
            3.0,
            1.0,
            2.0,
            3.0,
            1.0,
            2.0,
            3.0,
            4.1,
            4.1,
            3.0,
            4.2,
            2.0,
            4.2,
        ],
        "candid": [10, 11, 12, 13, 14, 15, 16, 17, 18, 20, 27, 19, 26, 29, 21],
        "trajectory_id": [1, 1, 1, 2, 2, 2, 3, 3, 3, 1, 2, 4, 4, 5, 5],
    }
)

night_to_night_old_observation_expected3 = pd.DataFrame(
    {
        "ra": [1, 2, 12, 11, 17],
        "dec": [7, 8, 6, 7, 10],
        "dcmag": [17.20, 13.26, 13.32, 18.28, 15.21],
        "fid": [2, 2, 2, 2, 2],
        "nid": [4, 4, 4, 4, 4],
        "jd": [4.1, 4.2, 4.1, 4.2, 4.2],
        "candid": [22, 23, 24, 25, 28],
    }
)

inter_night_report1 = {
    "nid of the next night": 4,
    "intra night report": {
        "number of separation association": 6,
        "number of association filtered by magnitude": 0,
        "association metrics": {
            "precision": 100.0,
            "recall": 100.0,
            "True Positif": 3,
            "False Positif": 0,
            "False Negatif": 0,
            "total real association": 3,
        },
        "number of intra night tracklets": 3,
    },
    "trajectory association report": {
        "list of updated trajectories": [1.0, 2.0],
        "all nid report": [
            {
                "old nid": 3,
                "trajectories_to_tracklets_report": {
                    "number of inter night separation based association": 2,
                    "number of inter night magnitude filtered association": 0,
                    "number of inter night angle filtered association": 1,
                    "number of duplicated association": 0,
                    "metrics": {},
                },
                "trajectories_to_new_observation_report": {
                    "number of inter night separation based association": 1,
                    "number of inter night magnitude filtered association": 0,
                    "number of inter night angle filtered association": 0,
                    "number of duplicated association": 0,
                    "metrics": {},
                },
            }
        ],
    },
    "tracklets and observation association report": {
        "list of updated trajectories": [5.0, 6.0, 7.0],
        "all nid report": [
            {
                "old nid": 3,
                "old observation to tracklets report": {
                    "number of inter night separation based association": 0,
                    "number of inter night magnitude filtered association": 0,
                    "number of inter night angle filtered association": 0,
                    "number of duplicated association": 0,
                    "metrics": {},
                },
                "old observation to new observation report": {
                    "number of inter night separation based association": 1,
                    "number of inter night magnitude filtered association": 0,
                    "metrics": {},
                    "number of duplicated association": 0,
                    "number of inter night angle filtered association": 0,
                },
            },
            {
                "old nid": 2,
                "old observation to tracklets report": {
                    "number of inter night separation based association": 0,
                    "number of inter night magnitude filtered association": 0,
                    "number of inter night angle filtered association": 0,
                    "number of duplicated association": 0,
                    "metrics": {},
                },
                "old observation to new observation report": {
                    "number of inter night separation based association": 0,
                    "number of inter night magnitude filtered association": 0,
                    "metrics": {},
                    "number of duplicated association": 0,
                    "number of inter night angle filtered association": 0,
                },
            },
        ],
    },
}

inter_night_report2 = {
    "nid of the next night": 4,
    "intra night report": {
        "number of separation association": 6,
        "number of association filtered by magnitude": 0,
        "association metrics": {},
        "number of intra night tracklets": 3,
    },
    "trajectory association report": {
        "list of updated trajectories": [],
        "all nid report": [],
    },
    "tracklets and observation association report": {
        "list of updated trajectories": [4.0, 5.0, 6.0, 7.0],
        "all nid report": [
            {
                "old nid": 3,
                "old observation to tracklets report": {
                    "number of inter night separation based association": 0,
                    "number of inter night magnitude filtered association": 0,
                    "number of inter night angle filtered association": 0,
                    "number of duplicated association": 0,
                    "metrics": {},
                },
                "old observation to new observation report": {
                    "number of inter night separation based association": 1,
                    "number of inter night magnitude filtered association": 0,
                    "number of duplicated association": 0,
                    "number of inter night angle filtered association": 0,
                },
            },
            {
                "old nid": 2,
                "old observation to tracklets report": {
                    "number of inter night separation based association": 0,
                    "number of inter night magnitude filtered association": 0,
                    "number of inter night angle filtered association": 0,
                    "number of duplicated association": 0,
                    "metrics": {},
                },
                "old observation to new observation report": {
                    "number of inter night separation based association": 0,
                    "number of inter night magnitude filtered association": 0,
                    "number of duplicated association": 0,
                    "number of inter night angle filtered association": 0,
                },
            },
        ],
    },
}

inter_night_report3 = {
    "nid of the next night": 4,
    "intra night report": {
        "number of separation association": 6,
        "number of association filtered by magnitude": 6,
        "association metrics": {},
        "number of intra night tracklets": 0,
    },
    "trajectory association report": {
        "list of updated trajectories": [1.0, 2.0],
        "all nid report": [
            {
                "old nid": 3,
                "trajectories_to_tracklets_report": {
                    "number of inter night separation based association": 0,
                    "number of inter night magnitude filtered association": 0,
                    "number of inter night angle filtered association": 0,
                    "number of duplicated association": 0,
                    "metrics": {},
                },
                "trajectories_to_new_observation_report": {
                    "number of inter night separation based association": 3,
                    "number of inter night magnitude filtered association": 0,
                    "number of inter night angle filtered association": 1,
                    "number of duplicated association": 0,
                    "metrics": {},
                },
            }
        ],
    },
    "tracklets and observation association report": {
        "list of updated trajectories": [4.0, 5.0],
        "all nid report": [
            {
                "old nid": 3,
                "old observation to tracklets report": {
                    "number of inter night separation based association": 0,
                    "number of inter night magnitude filtered association": 0,
                    "number of inter night angle filtered association": 0,
                    "number of duplicated association": 0,
                    "metrics": {},
                },
                "old observation to new observation report": {
                    "number of inter night separation based association": 1,
                    "number of inter night magnitude filtered association": 0,
                    "number of duplicated association": 0,
                    "number of inter night angle filtered association": 0,
                },
            },
            {
                "old nid": 2,
                "old observation to tracklets report": {
                    "number of inter night separation based association": 0,
                    "number of inter night magnitude filtered association": 0,
                    "number of inter night angle filtered association": 0,
                    "number of duplicated association": 0,
                    "metrics": {},
                },
                "old observation to new observation report": {
                    "number of inter night separation based association": 1,
                    "number of inter night magnitude filtered association": 0,
                    "number of duplicated association": 0,
                    "number of inter night angle filtered association": 0,
                },
            },
        ],
    },
}


# Trajectory and tracklets association test

trajectories_sample_1 = pd.DataFrame(
    {
        "ra": [1, 2, 3, 5, 6, 6, 1, 2, 3, 7, 8, 8, 9, 10, 11, 11],
        "dec": [1, 2, 3, 1, 1, 2, 7, 7, 7, 4, 5, 6, 1, 1, 1, 2],
        "dcmag": [
            12,
            12.02,
            12.04,
            13,
            13.02,
            13.04,
            14,
            14.02,
            14.04,
            15.04,
            15.06,
            15.07,
            16.02,
            16.04,
            16.06,
            16.07,
        ],
        "fid": [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
        "nid": [0, 0, 0, 1, 1, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 2],
        "jd": [
            0.1,
            0.2,
            0.3,
            1.1,
            1.2,
            1.3,
            2.1,
            2.2,
            2.3,
            1.1,
            1.2,
            1.3,
            1.1,
            1.2,
            1.3,
            2.1,
        ],
        "candid": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15],
        "trajectory_id": [0, 0, 0, 1, 1, 1, 2, 2, 2, 3, 3, 3, 4, 4, 4, 4],
    }
)

tracklets_sample_1 = pd.DataFrame(
    {
        "ra": [4, 5, 8, 8, 11, 11, 11, 7, 8],
        "dec": [4, 5, 7, 8, 3, 4, 5, 3, 3],
        "dcmag": [12.06, 12.07, 15.08, 15.09, 16.08, 16.09, 16.11, 17.01, 17.02],
        "fid": [1, 1, 1, 1, 1, 1, 1, 1, 1],
        "nid": [3, 3, 3, 3, 3, 3, 3, 3, 3],
        "jd": [3.1, 3.2, 3.1, 3.2, 3.1, 3.2, 3.3, 3.4, 3.5],
        "candid": [16, 17, 18, 19, 20, 21, 22, 23, 24],
        "trajectory_id": [10, 10, 11, 11, 12, 12, 12, 13, 13],
    }
)

# - test with duplicates

trajectories_sample_2 = pd.DataFrame(
    {
        "ra": [2, 3, 4, 10, 11, 12, 10, 11, 12, 3, 4, 5, 3, 4, 5],
        "dec": [3, 3, 3, 6, 6, 6, 2, 2, 2, 8, 8, 8, 10, 10, 10],
        "dcmag": [
            12,
            12.02,
            12.04,
            13.05,
            13.06,
            13.07,
            14.01,
            14.02,
            14.03,
            15.03,
            15.03,
            15.03,
            15.03,
            15.03,
            15.03,
        ],
        "fid": [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
        "nid": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        "jd": [
            0.1,
            0.2,
            0.3,
            0.3,
            0.4,
            0.5,
            0.1,
            0.2,
            0.3,
            0.3,
            0.4,
            0.5,
            0.1,
            0.2,
            0.3,
        ],
        "candid": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14],
        "trajectory_id": [0, 0, 0, 1, 1, 1, 2, 2, 2, 3, 3, 3, 4, 4, 4],
    }
)

tracklets_sample_2 = pd.DataFrame(
    {
        "ra": [5, 6, 5, 6, 13, 14, 13, 14, 13, 14, 5, 6, 6, 7],
        "dec": [4, 4, 2, 2, 7, 7, 5, 5, 2, 2, 3, 3, 9, 9],
        "dcmag": [
            12.06,
            12.07,
            12.06,
            12.07,
            13.08,
            13.09,
            13.03,
            13.04,
            14.03,
            14.04,
            12.06,
            12.07,
            15.03,
            15.03,
        ],
        "fid": [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
        "nid": [3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3],
        "jd": [3.1, 3.2, 3.1, 3.2, 3.1, 3.2, 3.1, 3.2, 3.1, 3.2, 3.1, 3.2, 3.1, 3.2],
        "candid": [16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29],
        "trajectory_id": [10, 10, 11, 11, 12, 12, 13, 13, 14, 14, 15, 15, 16, 16],
    }
)

# - expected outputs

trajectories_expected_1 = pd.DataFrame(
    {
        "ra": [1, 2, 3, 1, 2, 2, 6, 7, 8, 6, 7, 8, 9, 10, 10, 4, 5, 8, 7],
        "dec": [1, 2, 3, 12, 11, 10, 12, 12, 12, 6, 5, 6, 1, 2, 3, 4, 5, 7, 8],
        "dcmag": [
            12.02,
            12.05,
            12.3,
            15.0,
            15.1,
            15.23,
            13.0,
            12.6,
            12.75,
            17.02,
            17.15,
            17.27,
            16.0,
            16.4,
            16.7,
            12.4,
            12.52,
            17.31,
            17.43,
        ],
        "fid": [1, 1, 2, 1, 1, 1, 1, 2, 2, 2, 2, 2, 1, 2, 1, 1, 1, 1, 1],
        "nid": [1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 4, 4, 4, 4],
        "jd": [
            1.0,
            2.0,
            3.0,
            1.0,
            2.0,
            3.0,
            1.0,
            2.0,
            3.0,
            1.0,
            2.0,
            3.0,
            1.0,
            2.0,
            3.0,
            4.1,
            4.2,
            4.1,
            4.2,
        ],
        "candid": [
            10,
            11,
            12,
            13,
            14,
            15,
            16,
            17,
            18,
            19,
            20,
            21,
            22,
            23,
            24,
            25,
            26,
            29,
            30,
        ],
        "trajectory_id": [
            1.0,
            1.0,
            1.0,
            2.0,
            2.0,
            2.0,
            3.0,
            3.0,
            3.0,
            4.0,
            4.0,
            4.0,
            5.0,
            5.0,
            5.0,
            1.0,
            1.0,
            4.0,
            4.0,
        ],
        "provisional designation": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "a": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "e": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "i": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "long. node": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "arg. peric": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "mean anomaly": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_a": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_e": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_i": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_long. node": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_arg. peric": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_mean anomaly": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "not_updated": [
            False,
            False,
            False,
            True,
            True,
            True,
            True,
            True,
            True,
            False,
            False,
            False,
            True,
            True,
            True,
            False,
            False,
            False,
            False,
        ],
    }
)

tracklets_expected_1 = pd.DataFrame(
    {
        "ra": [1, 1, 13, 13],
        "dec": [9, 8, 1, 2],
        "dcmag": [15.94, 15.47, 16.21, 16.28],
        "fid": [2, 1, 2, 2],
        "nid": [4, 4, 4, 4],
        "jd": [4.1, 4.2, 4.1, 4.2],
        "candid": [27, 28, 31, 32],
        "trajectory_id": [11, 11, 13, 13],
        "provisional designation": [-1.0, -1.0, -1.0, -1.0],
        "a": [-1.0, -1.0, -1.0, -1.0],
        "e": [-1.0, -1.0, -1.0, -1.0],
        "i": [-1.0, -1.0, -1.0, -1.0],
        "long. node": [-1.0, -1.0, -1.0, -1.0],
        "arg. peric": [-1.0, -1.0, -1.0, -1.0],
        "mean anomaly": [-1.0, -1.0, -1.0, -1.0],
        "rms_a": [-1.0, -1.0, -1.0, -1.0],
        "rms_e": [-1.0, -1.0, -1.0, -1.0],
        "rms_i": [-1.0, -1.0, -1.0, -1.0],
        "rms_long. node": [-1.0, -1.0, -1.0, -1.0],
        "rms_arg. peric": [-1.0, -1.0, -1.0, -1.0],
        "rms_mean anomaly": [-1.0, -1.0, -1.0, -1.0],
    }
)

trajectories_expected_2 = pd.DataFrame(
    {
        "ra": [
            1,
            2,
            3,
            5,
            6,
            6,
            1,
            2,
            3,
            7,
            8,
            8,
            9,
            10,
            11,
            11,
            11,
            11,
            11,
            8,
            8,
            4,
            5,
        ],
        "dec": [1, 2, 3, 1, 1, 2, 7, 7, 7, 4, 5, 6, 1, 1, 1, 2, 3, 4, 5, 7, 8, 4, 5],
        "dcmag": [
            12.0,
            12.02,
            12.04,
            13.0,
            13.02,
            13.04,
            14.0,
            14.02,
            14.04,
            15.04,
            15.06,
            15.07,
            16.02,
            16.04,
            16.06,
            16.07,
            16.08,
            16.09,
            16.11,
            15.08,
            15.09,
            12.06,
            12.07,
        ],
        "fid": [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
        "nid": [0, 0, 0, 1, 1, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 2, 3, 3, 3, 3, 3, 3, 3],
        "jd": [
            0.1,
            0.2,
            0.3,
            1.1,
            1.2,
            1.3,
            2.1,
            2.2,
            2.3,
            1.1,
            1.2,
            1.3,
            1.1,
            1.2,
            1.3,
            2.1,
            3.1,
            3.2,
            3.3,
            3.1,
            3.2,
            3.1,
            3.2,
        ],
        "candid": [
            0,
            1,
            2,
            3,
            4,
            5,
            6,
            7,
            8,
            9,
            10,
            11,
            12,
            13,
            14,
            15,
            20,
            21,
            22,
            18,
            19,
            16,
            17,
        ],
        "trajectory_id": [
            0.0,
            0.0,
            0.0,
            1.0,
            1.0,
            1.0,
            2.0,
            2.0,
            2.0,
            3.0,
            3.0,
            3.0,
            4.0,
            4.0,
            4.0,
            4.0,
            4.0,
            4.0,
            4.0,
            3.0,
            3.0,
            0.0,
            0.0,
        ],
        "provisional designation": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "a": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "e": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "i": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "long. node": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "arg. peric": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "mean anomaly": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_a": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_e": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_i": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_long. node": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_arg. peric": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_mean anomaly": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "not_updated": [
            False,
            False,
            False,
            True,
            True,
            True,
            True,
            True,
            True,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
        ],
    }
)

tracklets_expected_2 = pd.DataFrame(
    {
        "ra": [7, 8],
        "dec": [3, 3],
        "dcmag": [17.01, 17.02],
        "fid": [1, 1],
        "nid": [3, 3],
        "jd": [3.4, 3.5],
        "candid": [23, 24],
        "trajectory_id": [13, 13],
        "provisional designation": [-1.0, -1.0],
        "a": [-1.0, -1.0],
        "e": [-1.0, -1.0],
        "i": [-1.0, -1.0],
        "long. node": [-1.0, -1.0],
        "arg. peric": [-1.0, -1.0],
        "mean anomaly": [-1.0, -1.0],
        "rms_a": [-1.0, -1.0],
        "rms_e": [-1.0, -1.0],
        "rms_i": [-1.0, -1.0],
        "rms_long. node": [-1.0, -1.0],
        "rms_arg. peric": [-1.0, -1.0],
        "rms_mean anomaly": [-1.0, -1.0],
    }
)

traj_and_track_assoc_report_expected = {
    "updated trajectories": [0.0, 3.0, 4.0],
    "all nid_report": [
        {
            "old nid": 2,
            "trajectories_to_tracklets_report": {
                "number of inter night separation based association": 2,
                "number of inter night magnitude filtered association": 1,
                "number of inter night angle filtered association": 0,
                "number of duplicated association": 0,
                "metrics": {},
            },
        },
        {
            "old nid": 1,
            "trajectories_to_tracklets_report": {
                "number of inter night separation based association": 1,
                "number of inter night magnitude filtered association": 0,
                "number of inter night angle filtered association": 0,
                "number of duplicated association": 0,
                "metrics": {},
            },
        },
        {
            "old nid": 0,
            "trajectories_to_tracklets_report": {
                "number of inter night separation based association": 2,
                "number of inter night magnitude filtered association": 1,
                "number of inter night angle filtered association": 0,
                "number of duplicated association": 0,
                "metrics": {},
            },
        },
    ],
}

trajectories_expected_3 = pd.DataFrame(
    {
        "ra": [
            2,
            3,
            4,
            10,
            11,
            12,
            10,
            11,
            12,
            3,
            4,
            5,
            3,
            4,
            5,
            2,
            3,
            4,
            5,
            6,
            2,
            3,
            4,
            5,
            6,
            10,
            11,
            12,
            13,
            14,
            5,
            6,
            13,
            14,
            13,
            14,
            6,
            7,
            6,
            7,
        ],
        "dec": [
            3,
            3,
            3,
            6,
            6,
            6,
            2,
            2,
            2,
            8,
            8,
            8,
            10,
            10,
            10,
            3,
            3,
            3,
            2,
            2,
            3,
            3,
            3,
            4,
            4,
            6,
            6,
            6,
            7,
            7,
            3,
            3,
            5,
            5,
            2,
            2,
            9,
            9,
            9,
            9,
        ],
        "dcmag": [
            12.0,
            12.02,
            12.04,
            13.05,
            13.06,
            13.07,
            14.01,
            14.02,
            14.03,
            15.03,
            15.03,
            15.03,
            15.03,
            15.03,
            15.03,
            12.0,
            12.02,
            12.04,
            12.06,
            12.07,
            12.0,
            12.02,
            12.04,
            12.06,
            12.07,
            13.05,
            13.06,
            13.07,
            13.08,
            13.09,
            12.06,
            12.07,
            13.03,
            13.04,
            14.03,
            14.04,
            15.03,
            15.03,
            15.03,
            15.03,
        ],
        "fid": [
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
        ],
        "nid": [
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            3,
            3,
            0,
            0,
            0,
            3,
            3,
            0,
            0,
            0,
            3,
            3,
            3,
            3,
            3,
            3,
            3,
            3,
            3,
            3,
            3,
            3,
        ],
        "jd": [
            0.1,
            0.2,
            0.3,
            0.3,
            0.4,
            0.5,
            0.1,
            0.2,
            0.3,
            0.3,
            0.4,
            0.5,
            0.1,
            0.2,
            0.3,
            0.1,
            0.2,
            0.3,
            3.1,
            3.2,
            0.1,
            0.2,
            0.3,
            3.1,
            3.2,
            0.3,
            0.4,
            0.5,
            3.1,
            3.2,
            3.1,
            3.2,
            3.1,
            3.2,
            3.1,
            3.2,
            3.1,
            3.2,
            3.1,
            3.2,
        ],
        "candid": [
            0,
            1,
            2,
            3,
            4,
            5,
            6,
            7,
            8,
            9,
            10,
            11,
            12,
            13,
            14,
            0,
            1,
            2,
            18,
            19,
            0,
            1,
            2,
            16,
            17,
            3,
            4,
            5,
            20,
            21,
            26,
            27,
            22,
            23,
            24,
            25,
            28,
            29,
            28,
            29,
        ],
        "trajectory_id": [
            0.0,
            0.0,
            0.0,
            1.0,
            1.0,
            1.0,
            2.0,
            2.0,
            2.0,
            3.0,
            3.0,
            3.0,
            4.0,
            4.0,
            4.0,
            5.0,
            5.0,
            5.0,
            5.0,
            5.0,
            6.0,
            6.0,
            6.0,
            6.0,
            6.0,
            7.0,
            7.0,
            7.0,
            7.0,
            7.0,
            0.0,
            0.0,
            1.0,
            1.0,
            2.0,
            2.0,
            3.0,
            3.0,
            4.0,
            4.0,
        ],
        "provisional designation": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "a": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "e": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "i": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "long. node": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "arg. peric": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "mean anomaly": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_a": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_e": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_i": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_long. node": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_arg. peric": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_mean anomaly": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "not_updated": [
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
        ],
    }
)


# Trajectories and new observations associations

trajectories_sample_3 = pd.DataFrame(
    {
        "ra": [1, 2, 3, 1, 2, 3, 7, 8, 9, 11, 12, 13, 15, 15, 15, 16, 17, 17],
        "dec": [1, 1, 1, 7, 7, 7, 3, 4, 5, 9, 9, 9, 2, 3, 4, 8, 8, 7],
        "dcmag": [
            11,
            11.01,
            11.02,
            12.01,
            12.01,
            12.02,
            13,
            13.02,
            13.03,
            14,
            14.02,
            14.03,
            15.01,
            15.01,
            15.02,
            16.04,
            16.05,
            16.06,
        ],
        "fid": [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
        "nid": [0, 0, 1, 0, 1, 1, 0, 1, 2, 0, 2, 2, 0, 0, 0, 0, 1, 1],
        "jd": [
            0.1,
            0.2,
            1.3,
            0.1,
            1.1,
            1.2,
            0.1,
            1.1,
            2.3,
            0.0,
            2.2,
            2.4,
            0.0,
            0.1,
            0.2,
            0.1,
            1.1,
            1.2,
        ],
        "candid": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17],
        "trajectory_id": [0, 0, 0, 1, 1, 1, 2, 2, 2, 3, 3, 3, 4, 4, 4, 5, 5, 5],
    }
)

new_observations_sample_1 = pd.DataFrame(
    {
        "ra": [4, 1, 3, 6, 6, 10, 15, 17],
        "dec": [1, 5, 4, 2, 8, 6, 5, 6],
        "dcmag": [11.03, 14.52, 17.84, 14.12, 16.25, 13.04, 15.03, 16.07],
        "fid": [1, 1, 1, 1, 1, 1, 1, 1],
        "nid": [3, 3, 3, 3, 3, 3, 3, 3],
        "jd": [3.1, 3.1, 3.2, 3.3, 3.4, 3.4, 3.4, 3.5],
        "candid": [18, 16, 20, 21, 22, 23, 24, 25],
    }
)

# - test with duplicates

trajectories_sample_4 = pd.DataFrame(
    {
        "ra": [2, 3, 4, 10, 11, 11, 17, 18, 19, 2, 3, 4],
        "dec": [2, 2, 2, 6, 6, 5, 5, 4, 3, 7, 7, 7],
        "dcmag": [
            11,
            11.01,
            11.02,
            12.01,
            12.01,
            12.02,
            13,
            13.02,
            13.03,
            14,
            14.02,
            14.03,
        ],
        "fid": [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
        "nid": [0, 1, 1, 0, 0, 0, 0, 1, 2, 0, 2, 2],
        "jd": [0.1, 1.2, 1.3, 0.1, 0.1, 0.2, 0.1, 1.1, 2.3, 0.0, 2.2, 2.4],
        "candid": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11],
        "trajectory_id": [0, 0, 0, 1, 1, 1, 2, 2, 2, 3, 3, 3],
    }
)

new_observations_sample_2 = pd.DataFrame(
    {
        "ra": [5, 5, 5, 6, 10, 12, 11, 12, 15, 18, 19, 20],
        "dec": [1, 2, 3, 5, 4, 4, 3, 1, 7, 3, 2, 2],
        "dcmag": [
            11.03,
            11.04,
            11.02,
            14.12,
            12.05,
            12.04,
            15.03,
            16.07,
            15.21,
            13.04,
            13.05,
            13.06,
        ],
        "fid": [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
        "nid": [3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3],
        "jd": [3.1, 3.1, 3.2, 3.3, 3.4, 3.4, 3.4, 3.5, 3.5, 3.4, 3.2, 3.1],
        "candid": [18, 16, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29],
    }
)

trajectories_sample_5 = pd.DataFrame(
    {
        "ra": [
            3,
            4,
            5,
            3,
            4,
            5,
            8,
            8,
            8,
            11,
            11,
            11,
            13,
            13,
            13,
            17,
            18,
            19,
            17,
            18,
            19,
        ],
        "dec": [3, 3, 3, 5, 5, 5, 1, 2, 3, 2, 3, 4, 2, 3, 4, 3, 3, 3, 5, 5, 5],
        "dcmag": [
            11,
            11.01,
            11.02,
            11,
            11.01,
            11.02,
            15.23,
            15.24,
            15.25,
            12.01,
            12.01,
            12.02,
            12.01,
            12.01,
            12.02,
            13,
            13.02,
            13.03,
            13,
            13.02,
            13.03,
        ],
        "fid": [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
        "nid": [0, 0, 1, 0, 1, 1, 0, 2, 2, 0, 1, 2, 0, 0, 1, 0, 1, 2, 0, 2, 2],
        "jd": [
            0.1,
            0.2,
            1.3,
            0.1,
            1.1,
            1.2,
            0.1,
            2.1,
            2.3,
            0.0,
            1.2,
            2.4,
            0.1,
            0.2,
            1.3,
            0.2,
            1.1,
            2.3,
            0.1,
            2.4,
            2.5,
        ],
        "candid": [
            0,
            1,
            2,
            3,
            4,
            5,
            6,
            7,
            8,
            9,
            10,
            11,
            12,
            13,
            14,
            15,
            16,
            17,
            18,
            19,
            20,
        ],
        "trajectory_id": [
            0,
            0,
            0,
            1,
            1,
            1,
            2,
            2,
            2,
            3,
            3,
            3,
            4,
            4,
            4,
            5,
            5,
            5,
            6,
            6,
            6,
        ],
    }
)

new_observations_sample_3 = pd.DataFrame(
    {
        "ra": [6, 8, 12, 20, 4],
        "dec": [4, 4, 5, 4, 7],
        "dcmag": [11.03, 15.29, 12.02, 13.12, 17.85],
        "fid": [1, 1, 1, 1, 1],
        "nid": [3, 3, 3, 3, 3],
        "jd": [3.1, 3.1, 3.2, 3.3, 3.5],
        "candid": [21, 22, 23, 24, 25],
    }
)

# - expected outputs

trajectories_expected_4 = pd.DataFrame(
    {
        "ra": [
            1,
            2,
            3,
            1,
            2,
            3,
            7,
            8,
            9,
            11,
            12,
            13,
            15,
            15,
            15,
            16,
            17,
            17,
            10,
            4,
            17,
            15,
        ],
        "dec": [1, 1, 1, 7, 7, 7, 3, 4, 5, 9, 9, 9, 2, 3, 4, 8, 8, 7, 6, 1, 6, 5],
        "dcmag": [
            11.0,
            11.01,
            11.02,
            12.01,
            12.01,
            12.02,
            13.0,
            13.02,
            13.03,
            14.0,
            14.02,
            14.03,
            15.01,
            15.01,
            15.02,
            16.04,
            16.05,
            16.06,
            13.04,
            11.03,
            16.07,
            15.03,
        ],
        "fid": [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
        "nid": [0, 0, 1, 0, 1, 1, 0, 1, 2, 0, 2, 2, 0, 0, 0, 0, 1, 1, 3, 3, 3, 3],
        "jd": [
            0.1,
            0.2,
            1.3,
            0.1,
            1.1,
            1.2,
            0.1,
            1.1,
            2.3,
            0.0,
            2.2,
            2.4,
            0.0,
            0.1,
            0.2,
            0.1,
            1.1,
            1.2,
            3.4,
            3.1,
            3.5,
            3.4,
        ],
        "candid": [
            0,
            1,
            2,
            3,
            4,
            5,
            6,
            7,
            8,
            9,
            10,
            11,
            12,
            13,
            14,
            15,
            16,
            17,
            23,
            18,
            25,
            24,
        ],
        "trajectory_id": [
            0,
            0,
            0,
            1,
            1,
            1,
            2,
            2,
            2,
            3,
            3,
            3,
            4,
            4,
            4,
            5,
            5,
            5,
            2,
            0,
            5,
            4,
        ],
        "provisional designation": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "a": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "e": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "i": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "long. node": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "arg. peric": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "mean anomaly": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_a": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_e": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_i": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_long. node": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_arg. peric": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_mean anomaly": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "not_updated": [
            False,
            False,
            False,
            True,
            True,
            True,
            False,
            False,
            False,
            True,
            True,
            True,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
        ],
    }
)

new_observations_expected_1 = pd.DataFrame(
    {
        "ra": [1, 3, 6, 6],
        "dec": [5, 4, 2, 8],
        "dcmag": [14.52, 17.84, 14.12, 16.25],
        "fid": [1, 1, 1, 1],
        "nid": [3, 3, 3, 3],
        "jd": [3.1, 3.2, 3.3, 3.4],
        "candid": [16, 20, 21, 22],
        "provisional designation": [-1.0, -1.0, -1.0, -1.0],
        "a": [-1.0, -1.0, -1.0, -1.0],
        "e": [-1.0, -1.0, -1.0, -1.0],
        "i": [-1.0, -1.0, -1.0, -1.0],
        "long. node": [-1.0, -1.0, -1.0, -1.0],
        "arg. peric": [-1.0, -1.0, -1.0, -1.0],
        "mean anomaly": [-1.0, -1.0, -1.0, -1.0],
        "rms_a": [-1.0, -1.0, -1.0, -1.0],
        "rms_e": [-1.0, -1.0, -1.0, -1.0],
        "rms_i": [-1.0, -1.0, -1.0, -1.0],
        "rms_long. node": [-1.0, -1.0, -1.0, -1.0],
        "rms_arg. peric": [-1.0, -1.0, -1.0, -1.0],
        "rms_mean anomaly": [-1.0, -1.0, -1.0, -1.0],
    }
)

expected_traj_obs_report_1 = {
    "traj to obs report": [
        {
            "old nid": 2,
            "trajectories_to_new_observation_report": {
                "number of inter night separation based association": 1,
                "number of inter night magnitude filtered association": 0,
                "number of inter night angle filtered association": 0,
                "number of duplicated association": 0,
                "metrics": {},
            },
        },
        {
            "old nid": 1,
            "trajectories_to_new_observation_report": {
                "number of inter night separation based association": 5,
                "number of inter night magnitude filtered association": 3,
                "number of inter night angle filtered association": 0,
                "number of duplicated association": 0,
                "metrics": {},
            },
        },
        {
            "old nid": 0,
            "trajectories_to_new_observation_report": {
                "number of inter night separation based association": 1,
                "number of inter night magnitude filtered association": 0,
                "number of inter night angle filtered association": 0,
                "number of duplicated association": 0,
                "metrics": {},
            },
        },
    ],
    "updated trajectories": [0.0, 2.0, 4.0, 5.0],
}


trajectories_expected_5 = pd.DataFrame(
    {
        "ra": [
            2.0,
            3.0,
            4.0,
            10.0,
            11.0,
            11.0,
            17.0,
            18.0,
            19.0,
            2.0,
            3.0,
            4.0,
            17.0,
            18.0,
            19.0,
            20.0,
            19.0,
            2.0,
            3.0,
            4.0,
            5.0,
            2.0,
            3.0,
            4.0,
            5.0,
            5.0,
            10.0,
            11.0,
            11.0,
            12.0,
            10.0,
        ],
        "dec": [
            2.0,
            2.0,
            2.0,
            6.0,
            6.0,
            5.0,
            5.0,
            4.0,
            3.0,
            7.0,
            7.0,
            7.0,
            5.0,
            4.0,
            3.0,
            2.0,
            2.0,
            2.0,
            2.0,
            2.0,
            2.0,
            2.0,
            2.0,
            2.0,
            3.0,
            1.0,
            6.0,
            6.0,
            5.0,
            4.0,
            4.0,
        ],
        "dcmag": [
            11.0,
            11.01,
            11.02,
            12.01,
            12.01,
            12.02,
            13.0,
            13.02,
            13.03,
            14.0,
            14.02,
            14.03,
            13.0,
            13.02,
            13.03,
            13.06,
            13.05,
            11.0,
            11.01,
            11.02,
            11.04,
            11.0,
            11.01,
            11.02,
            11.02,
            11.03,
            12.01,
            12.01,
            12.02,
            12.04,
            12.05,
        ],
        "fid": [
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
        ],
        "nid": [
            0.0,
            1.0,
            1.0,
            0.0,
            0.0,
            0.0,
            0.0,
            1.0,
            2.0,
            0.0,
            2.0,
            2.0,
            0.0,
            1.0,
            2.0,
            3.0,
            3.0,
            0.0,
            1.0,
            1.0,
            3.0,
            0.0,
            1.0,
            1.0,
            3.0,
            3.0,
            0.0,
            0.0,
            0.0,
            3.0,
            3.0,
        ],
        "jd": [
            0.1,
            1.2,
            1.3,
            0.1,
            0.1,
            0.2,
            0.1,
            1.1,
            2.3,
            0.0,
            2.2,
            2.4,
            0.1,
            1.1,
            2.3,
            3.1,
            3.2,
            0.1,
            1.2,
            1.3,
            3.1,
            0.1,
            1.2,
            1.3,
            3.2,
            3.1,
            0.1,
            0.1,
            0.2,
            3.4,
            3.4,
        ],
        "candid": [
            0.0,
            1.0,
            2.0,
            3.0,
            4.0,
            5.0,
            6.0,
            7.0,
            8.0,
            9.0,
            10.0,
            11.0,
            6.0,
            7.0,
            8.0,
            29.0,
            28.0,
            0.0,
            1.0,
            2.0,
            16.0,
            0.0,
            1.0,
            2.0,
            20.0,
            18.0,
            3.0,
            4.0,
            5.0,
            23.0,
            22.0,
        ],
        "trajectory_id": [
            0,
            0,
            0,
            1,
            1,
            1,
            2,
            2,
            2,
            3,
            3,
            3,
            4,
            4,
            4,
            4,
            2,
            5,
            5,
            5,
            5,
            6,
            6,
            6,
            6,
            0,
            7,
            7,
            7,
            7,
            1,
        ],
        "provisional designation": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "a": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "e": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "i": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "long. node": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "arg. peric": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "mean anomaly": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_a": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_e": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_i": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_long. node": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_arg. peric": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_mean anomaly": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "not_updated": [
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            True,
            True,
            True,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
        ],
    }
)

new_observations_expected_2 = pd.DataFrame(
    {
        "ra": [6, 11, 12, 15, 18],
        "dec": [5, 3, 1, 7, 3],
        "dcmag": [14.12, 15.03, 16.07, 15.21, 13.04],
        "fid": [1, 1, 1, 1, 1],
        "nid": [3, 3, 3, 3, 3],
        "jd": [3.3, 3.4, 3.5, 3.5, 3.4],
        "candid": [21, 24, 25, 26, 27],
        "provisional designation": [-1.0, -1.0, -1.0, -1.0, -1.0],
        "a": [-1.0, -1.0, -1.0, -1.0, -1.0],
        "e": [-1.0, -1.0, -1.0, -1.0, -1.0],
        "i": [-1.0, -1.0, -1.0, -1.0, -1.0],
        "long. node": [-1.0, -1.0, -1.0, -1.0, -1.0],
        "arg. peric": [-1.0, -1.0, -1.0, -1.0, -1.0],
        "mean anomaly": [-1.0, -1.0, -1.0, -1.0, -1.0],
        "rms_a": [-1.0, -1.0, -1.0, -1.0, -1.0],
        "rms_e": [-1.0, -1.0, -1.0, -1.0, -1.0],
        "rms_i": [-1.0, -1.0, -1.0, -1.0, -1.0],
        "rms_long. node": [-1.0, -1.0, -1.0, -1.0, -1.0],
        "rms_arg. peric": [-1.0, -1.0, -1.0, -1.0, -1.0],
        "rms_mean anomaly": [-1.0, -1.0, -1.0, -1.0, -1.0],
    }
)

expected_traj_obs_report_2 = {
    "traj to obs report": [
        {
            "old nid": 2,
            "trajectories_to_new_observation_report": {
                "number of inter night separation based association": 3,
                "number of inter night magnitude filtered association": 0,
                "number of inter night angle filtered association": 1,
                "number of duplicated association": 1,
                "metrics": {},
            },
        },
        {
            "old nid": 1,
            "trajectories_to_new_observation_report": {
                "number of inter night separation based association": 3,
                "number of inter night magnitude filtered association": 0,
                "number of inter night angle filtered association": 0,
                "number of duplicated association": 2,
                "metrics": {},
            },
        },
        {
            "old nid": 0,
            "trajectories_to_new_observation_report": {
                "number of inter night separation based association": 5,
                "number of inter night magnitude filtered association": 3,
                "number of inter night angle filtered association": 0,
                "number of duplicated association": 1,
                "metrics": {},
            },
        },
    ],
    "updated trajectories": [0, 1, 2, 4, 5, 6, 7],
}


trajectories_expected_6 = pd.DataFrame(
    {
        "ra": [
            3,
            4,
            5,
            3,
            4,
            5,
            8,
            8,
            8,
            11,
            11,
            11,
            13,
            13,
            13,
            17,
            18,
            19,
            17,
            18,
            19,
            8,
            12,
            20,
            20,
            6,
            6,
        ],
        "dec": [
            3,
            3,
            3,
            5,
            5,
            5,
            1,
            2,
            3,
            2,
            3,
            4,
            2,
            3,
            4,
            3,
            3,
            3,
            5,
            5,
            5,
            4,
            5,
            4,
            4,
            4,
            4,
        ],
        "dcmag": [
            11.0,
            11.01,
            11.02,
            11.0,
            11.01,
            11.02,
            15.23,
            15.24,
            15.25,
            12.01,
            12.01,
            12.02,
            12.01,
            12.01,
            12.02,
            13.0,
            13.02,
            13.03,
            13.0,
            13.02,
            13.03,
            15.29,
            12.02,
            13.12,
            13.12,
            11.03,
            11.03,
        ],
        "fid": [
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
        ],
        "nid": [
            0,
            0,
            1,
            0,
            1,
            1,
            0,
            2,
            2,
            0,
            1,
            2,
            0,
            0,
            1,
            0,
            1,
            2,
            0,
            2,
            2,
            3,
            3,
            3,
            3,
            3,
            3,
        ],
        "jd": [
            0.1,
            0.2,
            1.3,
            0.1,
            1.1,
            1.2,
            0.1,
            2.1,
            2.3,
            0.0,
            1.2,
            2.4,
            0.1,
            0.2,
            1.3,
            0.2,
            1.1,
            2.3,
            0.1,
            2.4,
            2.5,
            3.1,
            3.2,
            3.3,
            3.3,
            3.1,
            3.1,
        ],
        "candid": [
            0,
            1,
            2,
            3,
            4,
            5,
            6,
            7,
            8,
            9,
            10,
            11,
            12,
            13,
            14,
            15,
            16,
            17,
            18,
            19,
            20,
            22,
            23,
            24,
            24,
            21,
            21,
        ],
        "trajectory_id": [
            0,
            0,
            0,
            1,
            1,
            1,
            2,
            2,
            2,
            3,
            3,
            3,
            4,
            4,
            4,
            5,
            5,
            5,
            6,
            6,
            6,
            2,
            3,
            5,
            6,
            0,
            1,
        ],
        "provisional designation": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "a": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "e": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "i": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "long. node": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "arg. peric": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "mean anomaly": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_a": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_e": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_i": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_long. node": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_arg. peric": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_mean anomaly": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "not_updated": [
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            True,
            True,
            True,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
        ],
    }
)

new_observations_expected_3 = pd.DataFrame(
    {
        "ra": [4],
        "dec": [7],
        "dcmag": [17.85],
        "fid": [1],
        "nid": [3],
        "jd": [3.5],
        "candid": [25],
        "provisional designation": [-1.0],
        "a": [-1.0],
        "e": [-1.0],
        "i": [-1.0],
        "long. node": [-1.0],
        "arg. peric": [-1.0],
        "mean anomaly": [-1.0],
        "rms_a": [-1.0],
        "rms_e": [-1.0],
        "rms_i": [-1.0],
        "rms_long. node": [-1.0],
        "rms_arg. peric": [-1.0],
        "rms_mean anomaly": [-1.0],
    }
)

expected_traj_obs_report_3 = {
    "traj to obs report": [
        {
            "old nid": 2,
            "trajectories_to_new_observation_report": {
                "number of inter night separation based association": 4,
                "number of inter night magnitude filtered association": 0,
                "number of inter night angle filtered association": 0,
                "number of duplicated association": 0,
                "metrics": {},
            },
        },
        {
            "old nid": 1,
            "trajectories_to_new_observation_report": {
                "number of inter night separation based association": 3,
                "number of inter night magnitude filtered association": 1,
                "number of inter night angle filtered association": 0,
                "number of duplicated association": 0,
                "metrics": {},
            },
        },
    ],
    "updated trajectories": [0.0, 1.0, 2.0, 3.0, 5.0, 6.0],
}


# Tracklets and old observations associations


tracklets_sample_3 = pd.DataFrame(
    {
        "ra": [2, 3, 4, 5, 7, 8, 10, 11, 11, 12, 5, 6],
        "dec": [2, 3, 6, 6, 7, 7, 5, 6, 3, 3, 1, 2],
        "dcmag": [
            11,
            11.01,
            12.02,
            12.03,
            13.0,
            13.02,
            14.05,
            14.6,
            15.01,
            15.03,
            16.04,
            16.06,
        ],
        "fid": [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
        "nid": [3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3],
        "jd": [3.0, 3.1, 3.0, 3.1, 3.0, 3.1, 3.0, 3.1, 3.0, 3.1, 3.0, 3.1],
        "candid": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11],
        "trajectory_id": [0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5],
    }
)

old_observations_sample_1 = pd.DataFrame(
    {
        "ra": [1, 1, 3, 7, 9, 10],
        "dec": [1, 4, 6, 3, 4, 3],
        "dcmag": [11.01, 17.23, 12.02, 16.21, 14.04, 15.02],
        "fid": [1, 1, 1, 1, 1, 1],
        "nid": [0, 0, 1, 1, 2, 2],
        "jd": [0.1, 0.2, 1.2, 1.5, 2.4, 2.7],
        "candid": [12, 13, 14, 15, 16, 17],
    }
)

# - with duplicates

tracklets_sample_4 = pd.DataFrame(
    {
        "ra": [4, 5, 4, 5, 6, 7, 11, 11, 13, 13],
        "dec": [2, 2, 4, 4, 8, 8, 4, 3, 4, 3],
        "dcmag": [10.01, 10.2, 10.04, 10.05, 12.03, 12.06, 14.01, 14.05, 14.02, 14.06],
        "fid": [1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
        "nid": [3, 3, 3, 3, 3, 3, 3, 3, 3, 3],
        "jd": [3.0, 3.1, 3.0, 3.1, 3.0, 3.1, 3.0, 3.1, 3.0, 3.1],
        "candid": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
        "trajectory_id": [0, 0, 1, 1, 2, 2, 3, 3, 4, 4],
    }
)

old_observations_sample_2 = pd.DataFrame(
    {
        "ra": [3, 3, 2, 8, 12],
        "dec": [3, 5, 7, 4, 5],
        "dcmag": [10.0, 10.03, 15.42, 18.01, 14.02],
        "fid": [1, 1, 1, 1, 1],
        "nid": [0, 0, 1, 2, 1],
        "jd": [0.0, 0.2, 1.1, 2.3, 1.5],
        "candid": [10, 11, 12, 13, 14],
    }
)

tracklets_sample_5 = pd.DataFrame(
    {
        "ra": [3, 4, 12, 12, 5, 6],
        "dec": [2, 2, 4, 3, 6, 5],
        "dcmag": [10.01, 10.03, 11.02, 11.04, 14.06, 14.08],
        "fid": [1, 1, 1, 1, 1, 1],
        "nid": [3, 3, 3, 3, 3, 3],
        "jd": [3.0, 3.1, 3.0, 3.1, 3.0, 3.1],
        "candid": [0, 1, 2, 3, 4, 5],
        "trajectory_id": [0, 0, 1, 1, 2, 2],
    }
)

old_observations_sample_3 = pd.DataFrame(
    {
        "ra": [2, 2, 4, 5, 11, 13],
        "dec": [1, 3, 6, 7, 5, 5],
        "dcmag": [10.04, 10.06, 14.04, 14.06, 11.06, 11.02],
        "fid": [1, 1, 1, 1, 1, 1],
        "nid": [0, 0, 0, 2, 1, 1],
        "jd": [0.0, 0.1, 0.3, 2.1, 1.2, 1.3],
        "candid": [6, 7, 8, 9, 10, 11],
    }
)

# - expected outputs

tracklets_obs_expected_1 = pd.DataFrame(
    {
        "ra": [2, 3, 4, 5, 7, 8, 10, 11, 11, 12, 5, 6, 9, 10, 3, 1],
        "dec": [2, 3, 6, 6, 7, 7, 5, 6, 3, 3, 1, 2, 4, 3, 6, 1],
        "dcmag": [
            11.0,
            11.01,
            12.02,
            12.03,
            13.0,
            13.02,
            14.05,
            14.6,
            15.01,
            15.03,
            16.04,
            16.06,
            14.04,
            15.02,
            12.02,
            11.01,
        ],
        "fid": [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
        "nid": [3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, 2, 1, 0],
        "jd": [
            3.0,
            3.1,
            3.0,
            3.1,
            3.0,
            3.1,
            3.0,
            3.1,
            3.0,
            3.1,
            3.0,
            3.1,
            2.4,
            2.7,
            1.2,
            0.1,
        ],
        "candid": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 16, 17, 14, 12],
        "trajectory_id": [0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 3, 4, 1, 0],
        "provisional designation": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "a": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "e": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "i": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "long. node": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "arg. peric": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "mean anomaly": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_a": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_e": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_i": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_long. node": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_arg. peric": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_mean anomaly": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "not_updated": [
            False,
            False,
            False,
            False,
            True,
            True,
            False,
            False,
            False,
            False,
            True,
            True,
            False,
            False,
            False,
            False,
        ],
    }
)

old_obs_expected_1 = pd.DataFrame(
    {
        "ra": [1, 7],
        "dec": [4, 3],
        "dcmag": [17.23, 16.21],
        "fid": [1, 1],
        "nid": [0, 1],
        "jd": [0.2, 1.5],
        "candid": [13, 15],
        "provisional designation": [-1.0, -1.0],
        "a": [-1.0, -1.0],
        "e": [-1.0, -1.0],
        "i": [-1.0, -1.0],
        "long. node": [-1.0, -1.0],
        "arg. peric": [-1.0, -1.0],
        "mean anomaly": [-1.0, -1.0],
        "rms_a": [-1.0, -1.0],
        "rms_e": [-1.0, -1.0],
        "rms_i": [-1.0, -1.0],
        "rms_long. node": [-1.0, -1.0],
        "rms_arg. peric": [-1.0, -1.0],
        "rms_mean anomaly": [-1.0, -1.0],
    }
)

track_and_obs_report_expected_1 = {
    "track and obs report": [
        {
            "old nid": 2,
            "old observation to tracklets report": {
                "number of inter night separation based association": 2,
                "number of inter night magnitude filtered association": 0,
                "number of inter night angle filtered association": 0,
                "number of duplicated association": 0,
                "metrics": {},
            },
        },
        {
            "old nid": 1,
            "old observation to tracklets report": {
                "number of inter night separation based association": 2,
                "number of inter night magnitude filtered association": 0,
                "number of inter night angle filtered association": 1,
                "number of duplicated association": 0,
                "metrics": {},
            },
        },
        {
            "old nid": 0,
            "old observation to tracklets report": {
                "number of inter night separation based association": 3,
                "number of inter night magnitude filtered association": 2,
                "number of inter night angle filtered association": 0,
                "number of duplicated association": 0,
                "metrics": {},
            },
        },
    ],
    "updated tracklets": [0.0, 1.0, 3.0, 4.0],
}

tracklets_obs_expected_2 = pd.DataFrame(
    {
        "ra": [
            4.0,
            5.0,
            4.0,
            5.0,
            6.0,
            7.0,
            11.0,
            11.0,
            13.0,
            13.0,
            12.0,
            12.0,
            4.0,
            5.0,
            3.0,
            3.0,
            3.0,
        ],
        "dec": [
            2.0,
            2.0,
            4.0,
            4.0,
            8.0,
            8.0,
            4.0,
            3.0,
            4.0,
            3.0,
            5.0,
            5.0,
            4.0,
            4.0,
            5.0,
            3.0,
            3.0,
        ],
        "dcmag": [
            10.01,
            10.2,
            10.04,
            10.05,
            12.03,
            12.06,
            14.01,
            14.05,
            14.02,
            14.06,
            14.02,
            14.02,
            10.04,
            10.05,
            10.03,
            10.0,
            10.0,
        ],
        "fid": [
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
        ],
        "nid": [
            3.0,
            3.0,
            3.0,
            3.0,
            3.0,
            3.0,
            3.0,
            3.0,
            3.0,
            3.0,
            1.0,
            1.0,
            3.0,
            3.0,
            0.0,
            0.0,
            0.0,
        ],
        "jd": [
            3.0,
            3.1,
            3.0,
            3.1,
            3.0,
            3.1,
            3.0,
            3.1,
            3.0,
            3.1,
            1.5,
            1.5,
            3.0,
            3.1,
            0.2,
            0.0,
            0.0,
        ],
        "candid": [
            0.0,
            1.0,
            2.0,
            3.0,
            4.0,
            5.0,
            6.0,
            7.0,
            8.0,
            9.0,
            14.0,
            14.0,
            2.0,
            3.0,
            11.0,
            10.0,
            10.0,
        ],
        "trajectory_id": [0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 3, 4, 5, 5, 5, 0, 1],
        "provisional designation": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "a": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "e": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "i": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "long. node": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "arg. peric": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "mean anomaly": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_a": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_e": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_i": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_long. node": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_arg. peric": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_mean anomaly": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "not_updated": [
            False,
            False,
            False,
            False,
            True,
            True,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
        ],
    }
)

old_obs_expected_2 = pd.DataFrame(
    {
        "ra": [2, 8],
        "dec": [7, 4],
        "dcmag": [15.42, 18.01],
        "fid": [1, 1],
        "nid": [1, 2],
        "jd": [1.1, 2.3],
        "candid": [12, 13],
        "provisional designation": [-1.0, -1.0],
        "a": [-1.0, -1.0],
        "e": [-1.0, -1.0],
        "i": [-1.0, -1.0],
        "long. node": [-1.0, -1.0],
        "arg. peric": [-1.0, -1.0],
        "mean anomaly": [-1.0, -1.0],
        "rms_a": [-1.0, -1.0],
        "rms_e": [-1.0, -1.0],
        "rms_i": [-1.0, -1.0],
        "rms_long. node": [-1.0, -1.0],
        "rms_arg. peric": [-1.0, -1.0],
        "rms_mean anomaly": [-1.0, -1.0],
    }
)

track_and_obs_report_expected_2 = {
    "track and obs report": [
        {
            "old nid": 2,
            "old observation to tracklets report": {
                "number of inter night separation based association": 0,
                "number of inter night magnitude filtered association": 0,
                "number of inter night angle filtered association": 0,
                "number of duplicated association": 0,
                "metrics": {},
            },
        },
        {
            "old nid": 1,
            "old observation to tracklets report": {
                "number of inter night separation based association": 2,
                "number of inter night magnitude filtered association": 0,
                "number of inter night angle filtered association": 0,
                "number of duplicated association": 0,
                "metrics": {},
            },
        },
        {
            "old nid": 0,
            "old observation to tracklets report": {
                "number of inter night separation based association": 5,
                "number of inter night magnitude filtered association": 1,
                "number of inter night angle filtered association": 1,
                "number of duplicated association": 1,
                "metrics": {},
            },
        },
    ],
    "updated tracklets": [0.0, 1.0, 3.0, 4.0, 5.0],
}


tracklets_obs_expected_3 = pd.DataFrame(
    {
        "ra": [
            3.0,
            4.0,
            12.0,
            12.0,
            5.0,
            6.0,
            5.0,
            12.0,
            12.0,
            13.0,
            11.0,
            3.0,
            4.0,
            2.0,
            2.0,
        ],
        "dec": [
            2.0,
            2.0,
            4.0,
            3.0,
            6.0,
            5.0,
            7.0,
            4.0,
            3.0,
            5.0,
            5.0,
            2.0,
            2.0,
            3.0,
            1.0,
        ],
        "dcmag": [
            10.01,
            10.03,
            11.02,
            11.04,
            14.06,
            14.08,
            14.06,
            11.02,
            11.04,
            11.02,
            11.06,
            10.01,
            10.03,
            10.06,
            10.04,
        ],
        "fid": [
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
        ],
        "nid": [
            3.0,
            3.0,
            3.0,
            3.0,
            3.0,
            3.0,
            2.0,
            3.0,
            3.0,
            1.0,
            1.0,
            3.0,
            3.0,
            0.0,
            0.0,
        ],
        "jd": [
            3.0,
            3.1,
            3.0,
            3.1,
            3.0,
            3.1,
            2.1,
            3.0,
            3.1,
            1.3,
            1.2,
            3.0,
            3.1,
            0.1,
            0.0,
        ],
        "candid": [
            0.0,
            1.0,
            2.0,
            3.0,
            4.0,
            5.0,
            9.0,
            2.0,
            3.0,
            11.0,
            10.0,
            0.0,
            1.0,
            7.0,
            6.0,
        ],
        "trajectory_id": [0, 0, 1, 1, 2, 2, 2, 3, 3, 3, 1, 4, 4, 4, 0],
        "provisional designation": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "a": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "e": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "i": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "long. node": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "arg. peric": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "mean anomaly": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_a": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_e": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_i": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_long. node": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_arg. peric": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_mean anomaly": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "not_updated": [
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
        ],
    }
)

old_obs_expected_3 = pd.DataFrame(
    {
        "ra": [4],
        "dec": [6],
        "dcmag": [14.04],
        "fid": [1],
        "nid": [0],
        "jd": [0.3],
        "candid": [8],
        "provisional designation": [-1.0],
        "a": [-1.0],
        "e": [-1.0],
        "i": [-1.0],
        "long. node": [-1.0],
        "arg. peric": [-1.0],
        "mean anomaly": [-1.0],
        "rms_a": [-1.0],
        "rms_e": [-1.0],
        "rms_i": [-1.0],
        "rms_long. node": [-1.0],
        "rms_arg. peric": [-1.0],
        "rms_mean anomaly": [-1.0],
    }
)

track_and_obs_report_expected_3 = {
    "track and obs report": [
        {
            "old nid": 2,
            "old observation to tracklets report": {
                "number of inter night separation based association": 1,
                "number of inter night magnitude filtered association": 0,
                "number of inter night angle filtered association": 0,
                "number of duplicated association": 0,
                "metrics": {},
            },
        },
        {
            "old nid": 1,
            "old observation to tracklets report": {
                "number of inter night separation based association": 2,
                "number of inter night magnitude filtered association": 0,
                "number of inter night angle filtered association": 0,
                "number of duplicated association": 1,
                "metrics": {},
            },
        },
        {
            "old nid": 0,
            "old observation to tracklets report": {
                "number of inter night separation based association": 3,
                "number of inter night magnitude filtered association": 1,
                "number of inter night angle filtered association": 0,
                "number of duplicated association": 1,
                "metrics": {},
            },
        },
    ],
    "updated tracklets": [0.0, 1.0, 2.0, 3.0, 4.0],
}


# old observations with new observations associations test

old_observations_sample_4 = pd.DataFrame(
    {
        "ra": [1, 5, 2, 8, 11, 15],
        "dec": [1, 5, 9, 10, 5, 2],
        "dcmag": [11.01, 15.23, 12.02, 16.21, 14.04, 15.02],
        "fid": [1, 1, 1, 1, 1, 1],
        "nid": [2, 2, 1, 2, 0, 1],
        "jd": [2.1, 2.2, 1.2, 2.5, 0.4, 1.7],
        "candid": [0, 1, 2, 3, 4, 5],
    }
)

new_observation_sample_4 = pd.DataFrame(
    {
        "ra": [2, 3, 6, 7, 13, 17],
        "dec": [2, 8, 5, 2, 8, 6],
        "dcmag": [11.01, 12.08, 15.22, 16.21, 14.04, 15.02],
        "fid": [1, 1, 1, 1, 1, 1],
        "nid": [3, 3, 3, 3, 3, 3],
        "jd": [3.1, 3.2, 3.2, 3.5, 3.4, 3.7],
        "candid": [6, 7, 8, 9, 10, 11],
    }
)

# - expected outputs

new_trajectory = pd.DataFrame(
    {
        "ra": [1, 5, 2, 6, 2, 3, 11, 13],
        "dec": [1, 5, 2, 5, 9, 8, 5, 8],
        "dcmag": [11.01, 15.23, 11.01, 15.22, 12.02, 12.08, 14.04, 14.04],
        "fid": [1, 1, 1, 1, 1, 1, 1, 1],
        "nid": [2, 2, 3, 3, 1, 3, 0, 3],
        "jd": [2.1, 2.2, 3.1, 3.2, 1.2, 3.2, 0.4, 3.4],
        "candid": [0, 1, 6, 8, 2, 7, 4, 10],
        "trajectory_id": [0, 1, 0, 1, 2, 2, 3, 3],
    }
)

remaining_old_obs = pd.DataFrame(
    {
        "ra": [8, 15],
        "dec": [10, 2],
        "dcmag": [16.21, 15.02],
        "fid": [1, 1],
        "nid": [2, 1],
        "jd": [2.5, 1.7],
        "candid": [3, 5],
    }
)

remaining_new_obs = pd.DataFrame(
    {
        "ra": [7, 17],
        "dec": [2, 6],
        "dcmag": [16.21, 15.02],
        "fid": [1, 1],
        "nid": [3, 3],
        "jd": [3.5, 3.7],
        "candid": [9, 11],
    }
)

expected_obs_report = {
    "new trajectories": [0.0, 1.0, 2.0, 3.0],
    "all nid report": [
        {
            "old nid": 2,
            "observation associations": {
                "number of inter night separation based association": 2,
                "number of inter night magnitude filtered association": 0,
                "metrics": {},
                "number of duplicated association": 0,
                "number of inter night angle filtered association": 0,
            },
        },
        {
            "old nid": 1,
            "observation associations": {
                "number of inter night separation based association": 1,
                "number of inter night magnitude filtered association": 0,
                "metrics": {},
                "number of duplicated association": 0,
                "number of inter night angle filtered association": 0,
            },
        },
        {
            "old nid": 0,
            "observation associations": {
                "number of inter night separation based association": 1,
                "number of inter night magnitude filtered association": 0,
                "metrics": {},
                "number of duplicated association": 0,
                "number of inter night angle filtered association": 0,
            },
        },
    ],
}

# Test OrbFit

orbfit_samples = pd.DataFrame(
    {
        "ra": [
            81.9573635,
            90.2196466,
            90.9775852,
            92.1435109,
            95.3013857,
            232.2341868,
            231.1129767,
            231.0902895,
            229.1117136,
            225.6399955,
            225.1320369,
            224.1494043,
            224.1634648,
            223.6981941,
            222.8868291,
        ],
        "dec": [
            17.8940455,
            19.557214,
            19.6537084,
            19.7877896,
            20.0710622,
            -19.3694842,
            -18.6551774,
            -18.6566602,
            -18.7584283,
            -17.98425,
            -19.042805,
            -19.1458152,
            -17.6336513,
            -17.5222626,
            -19.3963402,
        ],
        "dcmag": [
            19.020416610644606,
            19.277157763192974,
            19.58262478343493,
            19.47009613328474,
            19.45875219190675,
            18.420662169461323,
            19.515643038956597,
            19.103981755075086,
            18.288246458485204,
            18.846686864667113,
            19.715124628473514,
            19.522913764553984,
            19.280371183840067,
            18.326972606767193,
            20.113162330613832,
        ],
        "fid": [2, 2, 2, 2, 2, 2, 1, 2, 1, 2, 1, 2, 2, 2, 1],
        "jd": [
            2459276.6515856,
            2459301.6557755,
            2459303.6663194,
            2459306.7054051,
            2459314.6574421,
            2459329.7716204,
            2459342.8558449,
            2459342.9366435,
            2459345.8568634,
            2459363.834375,
            2459365.7932176,
            2459370.7529051,
            2459373.7345139,
            2459377.7514468,
            2459379.689537,
        ],
        "trajectory_id": [2, 2, 2, 2, 2, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0],
    }
)

# - expected outputs

orbfit_output = pd.DataFrame(
    {
        "trajectory_id": [0, 1, 2],
        "provisional designation": ["K21J00A", "K21H00B", "K21E00C"],
        "ref_epoch": [2459365.748243189, 2459345.797868819, 2459303.631433099],
        "a": [2.2514377051961696, 3.151469406244868, 2.5327640885838534],
        "e": [0.125535937780582, 0.113946062348132, 0.21979650701275],
        "i": [6.4643575915582, 1.6879159876457, 6.5304532170756],
        "long. node": [50.5348303202514, 38.1016474068882, 150.4841279386873],
        "arg. peric": [210.5960462629447, 136.1915246941109, 250.4271289471135],
        "mean anomaly": [342.8711243628875, 46.5628893357021, 52.2712277027527],
        "rms_a": [0.00136864, 0.00794527, 0.141996],
        "rms_e": [0.00222514, 0.0183696, 0.014428],
        "rms_i": [0.0354767, 0.0477846, 0.0562678],
        "rms_long. node": [0.00670637, 0.317863, 0.555542],
        "rms_arg. peric": [1.13426, 13.4503, 10.4839],
        "rms_mean anomaly": [0.787228, 9.82298, 9.93615],
    }
)

# Test orbit_elem_dataframe - expected outputs

orb_elem_output = pd.DataFrame(
    {
        "trajectory_id": [0],
        "provisional designation": ["K21E00A"],
        "ref_epoch": [2459274.810893373],
        "a": [1.5834346988159376],
        "e": [0.613572037782866],
        "i": [5.9442185803697],
        "long. node": [343.795980283847],
        "arg. peric": [270.1932521117385],
        "mean anomaly": [333.9568546371023],
        "rms_a": [-1],
        "rms_e": [-1],
        "rms_i": [-1],
        "rms_long. node": [-1],
        "rms_arg. peric": [-1],
        "rms_mean anomaly": [-1],
    }
)

# Test compute_orbit_elem - expected outputs

compute_orbit_elem_output = pd.DataFrame(
    {
        "ra": [
            81.9573635,
            90.2196466,
            90.9775852,
            92.1435109,
            95.3013857,
            232.2341868,
            229.1117136,
            225.6399955,
            224.1634648,
            223.6981941,
            231.1129767,
            231.0902895,
            225.1320369,
            224.1494043,
            222.8868291,
        ],
        "dec": [
            17.8940455,
            19.557214,
            19.6537084,
            19.7877896,
            20.0710622,
            -19.3694842,
            -18.7584283,
            -17.98425,
            -17.6336513,
            -17.5222626,
            -18.6551774,
            -18.6566602,
            -19.042805,
            -19.1458152,
            -19.3963402,
        ],
        "dcmag": [
            19.020416610644606,
            19.277157763192974,
            19.58262478343493,
            19.47009613328474,
            19.45875219190675,
            18.420662169461323,
            18.288246458485204,
            18.846686864667113,
            19.280371183840067,
            18.326972606767193,
            19.515643038956597,
            19.103981755075086,
            19.715124628473514,
            19.522913764553984,
            20.113162330613832,
        ],
        "fid": [2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 1, 2, 1, 2, 1],
        "jd": [
            2459276.6515856,
            2459301.6557755,
            2459303.6663194,
            2459306.7054051,
            2459314.6574421,
            2459329.7716204,
            2459345.8568634,
            2459363.834375,
            2459373.7345139,
            2459377.7514468,
            2459342.8558449,
            2459342.9366435,
            2459365.7932176,
            2459370.7529051,
            2459379.689537,
        ],
        "trajectory_id": [2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0],
        "provisional designation": [
            "K21E00C",
            "K21E00C",
            "K21E00C",
            "K21E00C",
            "K21E00C",
            "K21H00B",
            "K21H00B",
            "K21H00B",
            "K21H00B",
            "K21H00B",
            "K21J00A",
            "K21J00A",
            "K21J00A",
            "K21J00A",
            "K21J00A",
        ],
        "ref_epoch": [
            2459303.631433099,
            2459303.631433099,
            2459303.631433099,
            2459303.631433099,
            2459303.631433099,
            2459345.797868819,
            2459345.797868819,
            2459345.797868819,
            2459345.797868819,
            2459345.797868819,
            2459365.748243189,
            2459365.748243189,
            2459365.748243189,
            2459365.748243189,
            2459365.748243189,
        ],
        "a": [
            2.5327640885838534,
            2.5327640885838534,
            2.5327640885838534,
            2.5327640885838534,
            2.5327640885838534,
            3.151469406244868,
            3.151469406244868,
            3.151469406244868,
            3.151469406244868,
            3.151469406244868,
            2.2514377051961696,
            2.2514377051961696,
            2.2514377051961696,
            2.2514377051961696,
            2.2514377051961696,
        ],
        "e": [
            0.21979650701275,
            0.21979650701275,
            0.21979650701275,
            0.21979650701275,
            0.21979650701275,
            0.113946062348132,
            0.113946062348132,
            0.113946062348132,
            0.113946062348132,
            0.113946062348132,
            0.125535937780582,
            0.125535937780582,
            0.125535937780582,
            0.125535937780582,
            0.125535937780582,
        ],
        "i": [
            6.5304532170756,
            6.5304532170756,
            6.5304532170756,
            6.5304532170756,
            6.5304532170756,
            1.6879159876457,
            1.6879159876457,
            1.6879159876457,
            1.6879159876457,
            1.6879159876457,
            6.4643575915582,
            6.4643575915582,
            6.4643575915582,
            6.4643575915582,
            6.4643575915582,
        ],
        "long. node": [
            150.4841279386873,
            150.4841279386873,
            150.4841279386873,
            150.4841279386873,
            150.4841279386873,
            38.1016474068882,
            38.1016474068882,
            38.1016474068882,
            38.1016474068882,
            38.1016474068882,
            50.5348303202514,
            50.5348303202514,
            50.5348303202514,
            50.5348303202514,
            50.5348303202514,
        ],
        "arg. peric": [
            250.4271289471135,
            250.4271289471135,
            250.4271289471135,
            250.4271289471135,
            250.4271289471135,
            136.1915246941109,
            136.1915246941109,
            136.1915246941109,
            136.1915246941109,
            136.1915246941109,
            210.5960462629447,
            210.5960462629447,
            210.5960462629447,
            210.5960462629447,
            210.5960462629447,
        ],
        "mean anomaly": [
            52.2712277027527,
            52.2712277027527,
            52.2712277027527,
            52.2712277027527,
            52.2712277027527,
            46.5628893357021,
            46.5628893357021,
            46.5628893357021,
            46.5628893357021,
            46.5628893357021,
            342.8711243628875,
            342.8711243628875,
            342.8711243628875,
            342.8711243628875,
            342.8711243628875,
        ],
        "rms_a": [
            0.141996,
            0.141996,
            0.141996,
            0.141996,
            0.141996,
            0.00794527,
            0.00794527,
            0.00794527,
            0.00794527,
            0.00794527,
            0.00136864,
            0.00136864,
            0.00136864,
            0.00136864,
            0.00136864,
        ],
        "rms_e": [
            0.014428,
            0.014428,
            0.014428,
            0.014428,
            0.014428,
            0.0183696,
            0.0183696,
            0.0183696,
            0.0183696,
            0.0183696,
            0.00222514,
            0.00222514,
            0.00222514,
            0.00222514,
            0.00222514,
        ],
        "rms_i": [
            0.0562678,
            0.0562678,
            0.0562678,
            0.0562678,
            0.0562678,
            0.0477846,
            0.0477846,
            0.0477846,
            0.0477846,
            0.0477846,
            0.0354767,
            0.0354767,
            0.0354767,
            0.0354767,
            0.0354767,
        ],
        "rms_long. node": [
            0.555542,
            0.555542,
            0.555542,
            0.555542,
            0.555542,
            0.317863,
            0.317863,
            0.317863,
            0.317863,
            0.317863,
            0.00670637,
            0.00670637,
            0.00670637,
            0.00670637,
            0.00670637,
        ],
        "rms_arg. peric": [
            10.4839,
            10.4839,
            10.4839,
            10.4839,
            10.4839,
            13.4503,
            13.4503,
            13.4503,
            13.4503,
            13.4503,
            1.13426,
            1.13426,
            1.13426,
            1.13426,
            1.13426,
        ],
        "rms_mean anomaly": [
            9.93615,
            9.93615,
            9.93615,
            9.93615,
            9.93615,
            9.82298,
            9.82298,
            9.82298,
            9.82298,
            9.82298,
            0.787228,
            0.787228,
            0.787228,
            0.787228,
            0.787228,
        ],
    }
)

# Test Intra night step for inter_night associations

input_observation = pd.DataFrame(
    {
        "ra": [
            190.3093822,
            192.4757989,
            250.1164907,
            249.0639657,
            328.36068,
            42.1808185,
            42.6036852,
            42.1815458,
            42.5304125,
            42.1822624,
            42.5310979,
            42.1830249,
            42.6053935,
            42.5318612,
            42.6059568,
            42.1837213,
            42.1846499,
            42.606639,
            42.5334801,
            42.185469,
            42.6073259,
            42.5343328,
            42.6079834,
            42.5351813,
            42.1863528,
            42.1871921,
            42.6086452,
            42.6093149,
            42.1881009,
        ],
        "dec": [
            -1.8656935,
            4.0747939,
            -25.1107537,
            -8.4772727,
            -9.3780665,
            24.9404015,
            26.4502336,
            24.9407228,
            23.465135,
            24.9410442,
            23.4653673,
            24.9413411,
            26.4509386,
            23.4655574,
            26.4511729,
            24.9416392,
            24.9420043,
            26.4514583,
            23.4660646,
            24.9423478,
            26.451733,
            23.4662918,
            26.4519922,
            23.4665642,
            24.9426992,
            24.9430564,
            26.4522669,
            26.4525455,
            24.9434112,
        ],
        "jd": [
            2459390.6913889,
            2459390.7134838,
            2459390.7453356,
            2459390.814456,
            2459390.8690972,
            2459390.9629745,
            2459390.9629745,
            2459390.9649769,
            2459390.9649769,
            2459390.9669907,
            2459390.9669907,
            2459390.9689931,
            2459390.9689931,
            2459390.9689931,
            2459390.9710069,
            2459390.9710069,
            2459390.9733912,
            2459390.9733912,
            2459390.9733912,
            2459390.9757523,
            2459390.9757523,
            2459390.9757523,
            2459390.9781134,
            2459390.9781134,
            2459390.9781134,
            2459390.9804745,
            2459390.9804745,
            2459390.9828472,
            2459390.9828472,
        ],
        "fid": [
            1,
            1,
            1,
            2,
            2,
            2,
            2,
            2,
            2,
            2,
            2,
            2,
            2,
            2,
            2,
            2,
            2,
            2,
            2,
            2,
            2,
            2,
            2,
            2,
            2,
            2,
            2,
            2,
            2,
        ],
        "nid": [
            1636,
            1636,
            1636,
            1636,
            1636,
            1636,
            1636,
            1636,
            1636,
            1636,
            1636,
            1636,
            1636,
            1636,
            1636,
            1636,
            1636,
            1636,
            1636,
            1636,
            1636,
            1636,
            1636,
            1636,
            1636,
            1636,
            1636,
            1636,
            1636,
        ],
        "dcmag": [
            18.314560154790556,
            18.00043889328813,
            18.22956917803643,
            18.671504334026544,
            18.97395169454908,
            17.32167894539666,
            14.18589614910271,
            17.408995803526878,
            17.204864326115214,
            17.295811143089832,
            17.190303194288884,
            17.300278772697972,
            14.200502024176384,
            17.188696167174,
            14.200700388434196,
            17.289626601611015,
            17.349472109274732,
            14.171918091768449,
            17.15134512124073,
            17.42240352052329,
            14.180283722871964,
            17.18776120850724,
            14.19692343234462,
            17.116678387486722,
            17.43911808647409,
            17.406475158998877,
            14.195819077486222,
            14.201333882232895,
            17.42343435989272,
        ],
        "candid": [
            1636191384715015000,
            1636213482115015000,
            1636245332415015004,
            1636314454515015038,
            1636369094215015007,
            1636462971915015003,
            1636462973515015007,
            1636464971915015001,
            1636464970015015029,
            1636466991915015002,
            1636466990015015026,
            1636468991915015002,
            1636468993515015005,
            1636468990015015032,
            1636471003515015005,
            1636471001915015001,
            1636473393015015000,
            1636473394615015007,
            1636473391315015012,
            1636475753015015001,
            1636475754615015004,
            1636475751315015012,
            1636478114615015003,
            1636478111315015007,
            1636478113015015000,
            1636480473015015000,
            1636480474615015006,
            1636482844615015006,
            1636482843015015001,
        ],
        "ssnamenr": [
            "4258",
            "4262",
            "22758",
            "23415",
            "42647",
            "4963",
            "760",
            "4963",
            "1936",
            "4963",
            "1936",
            "4963",
            "760",
            "1936",
            "760",
            "4963",
            "4963",
            "760",
            "1936",
            "4963",
            "760",
            "1936",
            "760",
            "1936",
            "4963",
            "4963",
            "760",
            "760",
            "4963",
        ],
    }
)

input_observation_2 = pd.DataFrame(
    {
        "ra": [190.3093822, 192.4757989, 249.0639657],
        "dec": [-1.8656935, 4.0747939, -8.4772727],
        "jd": [2459390.6913889, 2459390.7134838, 2459390.814456],
        "fid": [1, 1, 2],
        "nid": [1636, 1636, 1636],
        "dcmag": [18.314560154790556, 18.00043889328813, 18.671504334026544],
        "candid": [1636191384715015000, 1636213482115015000, 1636314454515015038],
        "ssnamenr": ["4258", "4262", "23415"],
    }
)

# - expected outputs

tracklets_output = pd.DataFrame(
    {
        "ra": [
            42.5343328,
            42.6086452,
            42.1871921,
            42.1808185,
            42.5304125,
            42.1815458,
            42.6036852,
            42.5310979,
            42.1822624,
            42.6053935,
            42.1830249,
            42.1837213,
            42.5318612,
            42.6059568,
            42.606639,
            42.1846499,
            42.5334801,
            42.185469,
            42.6073259,
            42.1863528,
            42.6079834,
            42.5351813,
            42.6093149,
            42.1881009,
        ],
        "dec": [
            23.4662918,
            26.4522669,
            24.9430564,
            24.9404015,
            23.465135,
            24.9407228,
            26.4502336,
            23.4653673,
            24.9410442,
            26.4509386,
            24.9413411,
            24.9416392,
            23.4655574,
            26.4511729,
            26.4514583,
            24.9420043,
            23.4660646,
            24.9423478,
            26.451733,
            24.9426992,
            26.4519922,
            23.4665642,
            26.4525455,
            24.9434112,
        ],
        "jd": [
            2459390.9757523,
            2459390.9804745,
            2459390.9804745,
            2459390.9629745,
            2459390.9649769,
            2459390.9649769,
            2459390.9629745,
            2459390.9669907,
            2459390.9669907,
            2459390.9689931,
            2459390.9689931,
            2459390.9710069,
            2459390.9689931,
            2459390.9710069,
            2459390.9733912,
            2459390.9733912,
            2459390.9733912,
            2459390.9757523,
            2459390.9757523,
            2459390.9781134,
            2459390.9781134,
            2459390.9781134,
            2459390.9828472,
            2459390.9828472,
        ],
        "fid": [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
        "nid": [
            1636,
            1636,
            1636,
            1636,
            1636,
            1636,
            1636,
            1636,
            1636,
            1636,
            1636,
            1636,
            1636,
            1636,
            1636,
            1636,
            1636,
            1636,
            1636,
            1636,
            1636,
            1636,
            1636,
            1636,
        ],
        "dcmag": [
            17.18776120850724,
            14.195819077486222,
            17.406475158998877,
            17.32167894539666,
            17.204864326115214,
            17.408995803526878,
            14.18589614910271,
            17.190303194288884,
            17.295811143089832,
            14.200502024176384,
            17.300278772697972,
            17.289626601611015,
            17.188696167174,
            14.200700388434196,
            14.171918091768449,
            17.349472109274732,
            17.15134512124073,
            17.42240352052329,
            14.180283722871964,
            17.43911808647409,
            14.19692343234462,
            17.116678387486722,
            14.201333882232895,
            17.42343435989272,
        ],
        "candid": [
            1636475751315015012,
            1636480474615015006,
            1636480473015015000,
            1636462971915015003,
            1636464970015015029,
            1636464971915015001,
            1636462973515015007,
            1636466990015015026,
            1636466991915015002,
            1636468993515015005,
            1636468991915015002,
            1636471001915015001,
            1636468990015015032,
            1636471003515015005,
            1636473394615015007,
            1636473393015015000,
            1636473391315015012,
            1636475753015015001,
            1636475754615015004,
            1636478113015015000,
            1636478114615015003,
            1636478111315015007,
            1636482844615015006,
            1636482843015015001,
        ],
        "ssnamenr": [
            "1936",
            "760",
            "4963",
            "4963",
            "1936",
            "4963",
            "760",
            "1936",
            "4963",
            "760",
            "4963",
            "4963",
            "1936",
            "760",
            "760",
            "4963",
            "1936",
            "4963",
            "760",
            "4963",
            "760",
            "1936",
            "760",
            "4963",
        ],
        "trajectory_id": [
            4,
            6,
            3,
            3,
            4,
            3,
            6,
            4,
            3,
            6,
            3,
            3,
            4,
            6,
            6,
            3,
            4,
            3,
            6,
            3,
            6,
            4,
            6,
            3,
        ],
    }
)

remaining_new_obs_output = pd.DataFrame(
    {
        "ra": [190.3093822, 192.4757989, 250.1164907, 249.0639657, 328.36068],
        "dec": [-1.8656935, 4.0747939, -25.1107537, -8.4772727, -9.3780665],
        "jd": [
            2459390.6913889,
            2459390.7134838,
            2459390.7453356,
            2459390.814456,
            2459390.8690972,
        ],
        "fid": [1, 1, 1, 2, 2],
        "nid": [1636, 1636, 1636, 1636, 1636],
        "dcmag": [
            18.314560154790556,
            18.00043889328813,
            18.22956917803643,
            18.671504334026544,
            18.97395169454908,
        ],
        "candid": [
            1636191384715015000,
            1636213482115015000,
            1636245332415015004,
            1636314454515015038,
            1636369094215015007,
        ],
        "ssnamenr": ["4258", "4262", "22758", "23415", "42647"],
    }
)

tracklets_expected_metrics = {
    "number of separation association": 176,
    "number of association filtered by magnitude": 0,
    "association metrics": {
        "precision": 100.0,
        "recall": 100.0,
        "True Positif": 21,
        "False Positif": 0,
        "False Negatif": 0,
        "total real association": 21,
    },
    "number of intra night tracklets": 3,
}


tracklets_output_2 = pd.DataFrame({"trajectory_id": []})

remaining_new_obs_output_2 = pd.DataFrame(
    {
        "ra": [190.3093822, 192.4757989, 249.0639657],
        "dec": [-1.8656935, 4.0747939, -8.4772727],
        "jd": [2459390.6913889, 2459390.7134838, 2459390.814456],
        "fid": [1, 1, 2],
        "nid": [1636, 1636, 1636],
        "dcmag": [18.314560154790556, 18.00043889328813, 18.671504334026544],
        "candid": [1636191384715015000, 1636213482115015000, 1636314454515015038],
        "ssnamenr": ["4258", "4262", "23415"],
    }
)

# Test Trajectories and Tracklets associations Steps in Inter night associations

traj_sample = pd.DataFrame(
    {
        "ra": [
            186.5040008,
            168.6524972,
            167.4181099,
            168.6523934,
            170.4261379,
            170.9717685,
            170.962155,
            167.4075773,
            170.4161533,
            168.643705,
            168.6436267,
            186.4808089,
        ],
        "dec": [
            44.7314698,
            0.9052992,
            0.7732693,
            0.9053366,
            -6.1125869,
            -13.4971232,
            -13.491155,
            0.7772116,
            -6.1111145,
            0.9088778,
            0.9089254,
            44.7262375,
        ],
        "jd": [
            2459291.781875,
            2459291.7905556,
            2459291.7910185,
            2459291.7910185,
            2459291.7910185,
            2459291.7926042,
            2459291.835625,
            2459291.836088,
            2459291.836088,
            2459291.836088,
            2459291.8365509,
            2459291.8407176,
        ],
        "fid": [1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2],
        "nid": [1537, 1537, 1537, 1537, 1537, 1537, 1537, 1537, 1537, 1537, 1537, 1537],
        "candid": [
            1537281870615015004,
            1537290551415015014,
            1537291016115015020,
            1537291016015015008,
            1537291011115015026,
            1537292601415015006,
            1537335621415015029,
            1537336086115015006,
            1537336081115015019,
            1537336086015015011,
            1537336551415015017,
            1537340710615015003,
        ],
        "dcmag": [
            18.24371301323446,
            16.743894489172938,
            17.368181071421624,
            16.723799914402477,
            14.332974466763252,
            17.537944743785797,
            16.929160615392856,
            16.83615755653922,
            18.644103030043368,
            16.216850388506607,
            16.240993228516896,
            17.64516573574104,
        ],
        "ssnamenr": [
            "99956",
            "3525",
            "5891",
            "3525",
            "99969",
            "10936",
            "10936",
            "5891",
            "99969",
            "3525",
            "3525",
            "99956",
        ],
        "trajectory_id": [3, 1, 2, 1, 4, 0, 0, 2, 4, 1, 1, 3],
        "not_updated": [
            True,
            True,
            True,
            True,
            True,
            True,
            True,
            True,
            True,
            True,
            True,
            True,
        ],
        "provisional designation": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "ref_epoch": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "a": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0],
        "e": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0],
        "i": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0],
        "long. node": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "arg. peric": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "mean anomaly": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_a": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_e": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_i": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_long. node": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_arg. peric": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_mean anomaly": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
    }
)

track_sample = pd.DataFrame(
    {
        "ra": [
            116.3740686,
            116.378338,
            167.2025741,
            170.7601106,
            170.7599095,
            167.1931768,
            168.4665006,
            167.1930804,
            162.624763,
            162.6243687,
            162.6237897,
            170.7460899,
            170.745984,
            167.1832584,
            168.4583886,
            162.6115944,
            162.6114272,
            162.6110749,
            203.95862,
            203.9477719,
        ],
        "dec": [
            46.9331292,
            46.9186626,
            0.8573175,
            -13.3601006,
            -13.3599521,
            0.8608448,
            0.9842065,
            0.860896,
            44.0008725,
            44.0006253,
            44.0002676,
            -13.3511835,
            -13.351098,
            0.8646139,
            0.9875339,
            43.9922395,
            43.9921097,
            43.9918713,
            -6.09188,
            -6.0865106,
        ],
        "jd": [
            2459292.6814699,
            2459292.7236343,
            2459292.753206,
            2459292.7726042,
            2459292.7735301,
            2459292.7938194,
            2459292.794294,
            2459292.794294,
            2459292.8075116,
            2459292.8084606,
            2459292.8098843,
            2459292.8358912,
            2459292.8363657,
            2459292.8368519,
            2459292.8368519,
            2459292.8411574,
            2459292.8416319,
            2459292.842581,
            2459292.8774421,
            2459292.936794,
        ],
        "fid": [1, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 1],
        "nid": [
            1538,
            1538,
            1538,
            1538,
            1538,
            1538,
            1538,
            1538,
            1538,
            1538,
            1538,
            1538,
            1538,
            1538,
            1538,
            1538,
            1538,
            1538,
            1538,
            1538,
        ],
        "candid": [
            1538181462815015010,
            1538223632815015014,
            1538253204815015007,
            1538272605615015000,
            1538273530315015016,
            1538293814815015009,
            1538294290315015019,
            1538294290215015013,
            1538307511415015016,
            1538308466015015005,
            1538309884815015004,
            1538335895615015000,
            1538336360315015011,
            1538336850215015012,
            1538336850315015022,
            1538341154815015003,
            1538341636015015009,
            1538342581415015003,
            1538377441515015040,
            1538436791515015047,
        ],
        "dcmag": [
            18.75538096440109,
            17.388190194142993,
            16.38345096268365,
            17.407960400594295,
            17.45544077836076,
            17.399079120824545,
            16.882386749897492,
            17.422983631636527,
            17.070684603766836,
            17.018834560517735,
            17.03552357727233,
            16.870491564990747,
            16.890761891765294,
            16.598299027841747,
            16.251481761141033,
            16.31657739361883,
            16.321679024232985,
            16.295972237444545,
            18.96152984542355,
            19.184091428608127,
        ],
        "ssnamenr": [
            "99949",
            "99949",
            "5891",
            "10936",
            "10936",
            "5891",
            "3525",
            "5891",
            "29147",
            "29147",
            "29147",
            "10936",
            "10936",
            "5891",
            "3525",
            "29147",
            "29147",
            "29147",
            "99946",
            "99946",
        ],
        "trajectory_id": [8, 8, 6, 3, 3, 6, 5, 6, 4, 4, 4, 3, 3, 6, 5, 4, 4, 4, 7, 7],
        "not_updated": [
            True,
            True,
            True,
            True,
            True,
            True,
            True,
            True,
            True,
            True,
            True,
            True,
            True,
            True,
            True,
            True,
            True,
            True,
            True,
            True,
        ],
        "provisional designation": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "ref_epoch": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "a": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "e": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "i": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "long. node": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "arg. peric": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "mean anomaly": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_a": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_e": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_i": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_long. node": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_arg. peric": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_mean anomaly": [
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
    }
)

# - expected outputs

traj_not_updated_expected = pd.DataFrame(
    {
        "ra": [186.5040008, 170.4261379, 170.4161533, 186.4808089],
        "dec": [44.7314698, -6.1125869, -6.1111145, 44.7262375],
        "jd": [2459291.781875, 2459291.7910185, 2459291.836088, 2459291.8407176],
        "fid": [1, 1, 2, 2],
        "nid": [1537, 1537, 1537, 1537],
        "candid": [
            1537281870615015004,
            1537291011115015026,
            1537336081115015019,
            1537340710615015003,
        ],
        "dcmag": [
            18.24371301323446,
            14.332974466763252,
            18.644103030043368,
            17.64516573574104,
        ],
        "ssnamenr": ["99956", "99969", "99969", "99956"],
        "trajectory_id": [3, 4, 4, 3],
        "not_updated": [True, True, True, True],
        "provisional designation": [-1.0, -1.0, -1.0, -1.0],
        "ref_epoch": [-1.0, -1.0, -1.0, -1.0],
        "a": [-1.0, -1.0, -1.0, -1.0],
        "e": [-1.0, -1.0, -1.0, -1.0],
        "i": [-1.0, -1.0, -1.0, -1.0],
        "long. node": [-1.0, -1.0, -1.0, -1.0],
        "arg. peric": [-1.0, -1.0, -1.0, -1.0],
        "mean anomaly": [-1.0, -1.0, -1.0, -1.0],
        "rms_a": [-1.0, -1.0, -1.0, -1.0],
        "rms_e": [-1.0, -1.0, -1.0, -1.0],
        "rms_i": [-1.0, -1.0, -1.0, -1.0],
        "rms_long. node": [-1.0, -1.0, -1.0, -1.0],
        "rms_arg. peric": [-1.0, -1.0, -1.0, -1.0],
        "rms_mean anomaly": [-1.0, -1.0, -1.0, -1.0],
    }
)

other_track_expected = pd.DataFrame(
    {
        "ra": [116.3740686, 116.378338, 203.95862, 203.9477719],
        "dec": [46.9331292, 46.9186626, -6.09188, -6.0865106],
        "jd": [2459292.6814699, 2459292.7236343, 2459292.8774421, 2459292.936794],
        "fid": [1, 2, 2, 1],
        "nid": [1538, 1538, 1538, 1538],
        "candid": [
            1538181462815015010,
            1538223632815015014,
            1538377441515015040,
            1538436791515015047,
        ],
        "dcmag": [
            18.75538096440109,
            17.388190194142993,
            18.96152984542355,
            19.184091428608127,
        ],
        "ssnamenr": ["99949", "99949", "99946", "99946"],
        "trajectory_id": [8, 8, 7, 7],
        "not_updated": [True, True, True, True],
        "provisional designation": [-1.0, -1.0, -1.0, -1.0],
        "ref_epoch": [-1.0, -1.0, -1.0, -1.0],
        "a": [-1.0, -1.0, -1.0, -1.0],
        "e": [-1.0, -1.0, -1.0, -1.0],
        "i": [-1.0, -1.0, -1.0, -1.0],
        "long. node": [-1.0, -1.0, -1.0, -1.0],
        "arg. peric": [-1.0, -1.0, -1.0, -1.0],
        "mean anomaly": [-1.0, -1.0, -1.0, -1.0],
        "rms_a": [-1.0, -1.0, -1.0, -1.0],
        "rms_e": [-1.0, -1.0, -1.0, -1.0],
        "rms_i": [-1.0, -1.0, -1.0, -1.0],
        "rms_long. node": [-1.0, -1.0, -1.0, -1.0],
        "rms_arg. peric": [-1.0, -1.0, -1.0, -1.0],
        "rms_mean anomaly": [-1.0, -1.0, -1.0, -1.0],
    }
)

track_orb_expected = pd.DataFrame(
    {
        "ra": [
            168.6524972,
            168.6523934,
            168.643705,
            168.6436267,
            168.4665006,
            168.4583886,
            167.4181099,
            167.4075773,
            167.2025741,
            167.1931768,
            167.1930804,
            167.1832584,
            170.9717685,
            170.962155,
            170.7601106,
            170.7599095,
            170.7460899,
            170.745984,
            162.624763,
            162.6243687,
            162.6237897,
            162.6115944,
            162.6114272,
            162.6110749,
        ],
        "dec": [
            0.9052992,
            0.9053366,
            0.9088778,
            0.9089254,
            0.9842065,
            0.9875339,
            0.7732693,
            0.7772116,
            0.8573175,
            0.8608448,
            0.860896,
            0.8646139,
            -13.4971232,
            -13.491155,
            -13.3601006,
            -13.3599521,
            -13.3511835,
            -13.351098,
            44.0008725,
            44.0006253,
            44.0002676,
            43.9922395,
            43.9921097,
            43.9918713,
        ],
        "jd": [
            2459291.7905556,
            2459291.7910185,
            2459291.836088,
            2459291.8365509,
            2459292.794294,
            2459292.8368519,
            2459291.7910185,
            2459291.836088,
            2459292.753206,
            2459292.7938194,
            2459292.794294,
            2459292.8368519,
            2459291.7926042,
            2459291.835625,
            2459292.7726042,
            2459292.7735301,
            2459292.8358912,
            2459292.8363657,
            2459292.8075116,
            2459292.8084606,
            2459292.8098843,
            2459292.8411574,
            2459292.8416319,
            2459292.842581,
        ],
        "fid": [1, 1, 2, 2, 1, 2, 1, 2, 2, 1, 1, 2, 1, 2, 1, 1, 2, 2, 1, 1, 1, 2, 2, 2],
        "nid": [
            1537,
            1537,
            1537,
            1537,
            1538,
            1538,
            1537,
            1537,
            1538,
            1538,
            1538,
            1538,
            1537,
            1537,
            1538,
            1538,
            1538,
            1538,
            1538,
            1538,
            1538,
            1538,
            1538,
            1538,
        ],
        "candid": [
            1537290551415015014,
            1537291016015015008,
            1537336086015015011,
            1537336551415015017,
            1538294290315015019,
            1538336850315015022,
            1537291016115015020,
            1537336086115015006,
            1538253204815015007,
            1538293814815015009,
            1538294290215015013,
            1538336850215015012,
            1537292601415015006,
            1537335621415015029,
            1538272605615015000,
            1538273530315015016,
            1538335895615015000,
            1538336360315015011,
            1538307511415015016,
            1538308466015015005,
            1538309884815015004,
            1538341154815015003,
            1538341636015015009,
            1538342581415015003,
        ],
        "dcmag": [
            16.743894489172938,
            16.723799914402477,
            16.216850388506607,
            16.240993228516896,
            16.882386749897492,
            16.251481761141033,
            17.368181071421624,
            16.83615755653922,
            16.38345096268365,
            17.399079120824545,
            17.422983631636527,
            16.598299027841747,
            17.537944743785797,
            16.929160615392856,
            17.407960400594295,
            17.45544077836076,
            16.870491564990747,
            16.890761891765294,
            17.070684603766836,
            17.018834560517735,
            17.03552357727233,
            16.31657739361883,
            16.321679024232985,
            16.295972237444545,
        ],
        "ssnamenr": [
            "3525",
            "3525",
            "3525",
            "3525",
            "3525",
            "3525",
            "5891",
            "5891",
            "5891",
            "5891",
            "5891",
            "5891",
            "10936",
            "10936",
            "10936",
            "10936",
            "10936",
            "10936",
            "29147",
            "29147",
            "29147",
            "29147",
            "29147",
            "29147",
        ],
        "trajectory_id": [
            1,
            1,
            1,
            1,
            1,
            1,
            2,
            2,
            2,
            2,
            2,
            2,
            0,
            0,
            0,
            0,
            0,
            0,
            4,
            4,
            4,
            4,
            4,
            4,
        ],
        "not_updated": [
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            False,
            True,
            True,
            True,
            True,
            True,
            True,
        ],
        "provisional designation": [
            "K21F00B",
            "K21F00B",
            "K21F00B",
            "K21F00B",
            "K21F00B",
            "K21F00B",
            "K21F00C",
            "K21F00C",
            "K21F00C",
            "K21F00C",
            "K21F00C",
            "K21F00C",
            "K21F00A",
            "K21F00A",
            "K21F00A",
            "K21F00A",
            "K21F00A",
            "K21F00A",
            "K21F00E",
            "K21F00E",
            "K21F00E",
            "K21F00E",
            "K21F00E",
            "K21F00E",
        ],
        "ref_epoch": [
            2459291.789210112,
            2459291.789210112,
            2459291.789210112,
            2459291.789210112,
            2459291.789210112,
            2459291.789210112,
            2459292.718054266,
            2459292.718054266,
            2459292.718054266,
            2459292.718054266,
            2459292.718054266,
            2459292.718054266,
            2459292.73460517,
            2459292.73460517,
            2459292.73460517,
            2459292.73460517,
            2459292.73460517,
            2459292.73460517,
            2459292.768442254,
            2459292.768442254,
            2459292.768442254,
            2459292.768442254,
            2459292.768442254,
            2459292.768442254,
        ],
        "a": [
            1.5594458258545376,
            1.5594458258545376,
            1.5594458258545376,
            1.5594458258545376,
            1.5594458258545376,
            1.5594458258545376,
            1.4462064013710052,
            1.4462064013710052,
            1.4462064013710052,
            1.4462064013710052,
            1.4462064013710052,
            1.4462064013710052,
            1.9032227444969525,
            1.9032227444969525,
            1.9032227444969525,
            1.9032227444969525,
            1.9032227444969525,
            1.9032227444969525,
            0.8730891087395078,
            0.8730891087395078,
            0.8730891087395078,
            0.8730891087395078,
            0.8730891087395078,
            0.8730891087395078,
        ],
        "e": [
            0.172256182065894,
            0.172256182065894,
            0.172256182065894,
            0.172256182065894,
            0.172256182065894,
            0.172256182065894,
            0.139367513692952,
            0.139367513692952,
            0.139367513692952,
            0.139367513692952,
            0.139367513692952,
            0.139367513692952,
            0.459819549638921,
            0.459819549638921,
            0.459819549638921,
            0.459819549638921,
            0.459819549638921,
            0.459819549638921,
            0.497692465488354,
            0.497692465488354,
            0.497692465488354,
            0.497692465488354,
            0.497692465488354,
            0.497692465488354,
        ],
        "i": [
            1.0220122860974,
            1.0220122860974,
            1.0220122860974,
            1.0220122860974,
            1.0220122860974,
            1.0220122860974,
            0.918009608608,
            0.918009608608,
            0.918009608608,
            0.918009608608,
            0.918009608608,
            0.918009608608,
            6.9612786598719,
            6.9612786598719,
            6.9612786598719,
            6.9612786598719,
            6.9612786598719,
            6.9612786598719,
            24.7057279848316,
            24.7057279848316,
            24.7057279848316,
            24.7057279848316,
            24.7057279848316,
            24.7057279848316,
        ],
        "long. node": [
            288.6120986672522,
            288.6120986672522,
            288.6120986672522,
            288.6120986672522,
            288.6120986672522,
            288.6120986672522,
            269.3579776383178,
            269.3579776383178,
            269.3579776383178,
            269.3579776383178,
            269.3579776383178,
            269.3579776383178,
            212.2493719594941,
            212.2493719594941,
            212.2493719594941,
            212.2493719594941,
            212.2493719594941,
            212.2493719594941,
            178.1158147605084,
            178.1158147605084,
            178.1158147605084,
            178.1158147605084,
            178.1158147605084,
            178.1158147605084,
        ],
        "arg. peric": [
            207.1873987749459,
            207.1873987749459,
            207.1873987749459,
            207.1873987749459,
            207.1873987749459,
            207.1873987749459,
            295.3599644206949,
            295.3599644206949,
            295.3599644206949,
            295.3599644206949,
            295.3599644206949,
            295.3599644206949,
            37.6056256827322,
            37.6056256827322,
            37.6056256827322,
            37.6056256827322,
            37.6056256827322,
            37.6056256827322,
            226.8795515938161,
            226.8795515938161,
            226.8795515938161,
            226.8795515938161,
            226.8795515938161,
            226.8795515938161,
        ],
        "mean anomaly": [
            28.241005628507,
            28.241005628507,
            28.241005628507,
            28.241005628507,
            28.241005628507,
            28.241005628507,
            338.5028854397608,
            338.5028854397608,
            338.5028854397608,
            338.5028854397608,
            338.5028854397608,
            338.5028854397608,
            331.8559683537305,
            331.8559683537305,
            331.8559683537305,
            331.8559683537305,
            331.8559683537305,
            331.8559683537305,
            79.5632109542564,
            79.5632109542564,
            79.5632109542564,
            79.5632109542564,
            79.5632109542564,
            79.5632109542564,
        ],
        "rms_a": [
            0.258929,
            0.258929,
            0.258929,
            0.258929,
            0.258929,
            0.258929,
            0.64071,
            0.64071,
            0.64071,
            0.64071,
            0.64071,
            0.64071,
            2.74117,
            2.74117,
            2.74117,
            2.74117,
            2.74117,
            2.74117,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_e": [
            0.754295,
            0.754295,
            0.754295,
            0.754295,
            0.754295,
            0.754295,
            0.671775,
            0.671775,
            0.671775,
            0.671775,
            0.671775,
            0.671775,
            1.1332,
            1.1332,
            1.1332,
            1.1332,
            1.1332,
            1.1332,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_i": [
            1.62077,
            1.62077,
            1.62077,
            1.62077,
            1.62077,
            1.62077,
            0.228178,
            0.228178,
            0.228178,
            0.228178,
            0.228178,
            0.228178,
            10.1345,
            10.1345,
            10.1345,
            10.1345,
            10.1345,
            10.1345,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_long. node": [
            208.206,
            208.206,
            208.206,
            208.206,
            208.206,
            208.206,
            171.595,
            171.595,
            171.595,
            171.595,
            171.595,
            171.595,
            53.6465,
            53.6465,
            53.6465,
            53.6465,
            53.6465,
            53.6465,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_arg. peric": [
            702.416,
            702.416,
            702.416,
            702.416,
            702.416,
            702.416,
            452.797,
            452.797,
            452.797,
            452.797,
            452.797,
            452.797,
            86.8301,
            86.8301,
            86.8301,
            86.8301,
            86.8301,
            86.8301,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
        "rms_mean anomaly": [
            323.21,
            323.21,
            323.21,
            323.21,
            323.21,
            323.21,
            186.21,
            186.21,
            186.21,
            186.21,
            186.21,
            186.21,
            71.91,
            71.91,
            71.91,
            71.91,
            71.91,
            71.91,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
            -1.0,
        ],
    }
)

traj_track_metrics_expected = {
    "updated trajectories": [0.0, 1.0, 2.0],
    "all nid_report": [
        {
            "old nid": 1537,
            "trajectories_to_tracklets_report": {
                "number of inter night separation based association": 3,
                "number of inter night magnitude filtered association": 0,
                "number of inter night angle filtered association": 0,
                "number of duplicated association": 0,
                "metrics": {
                    "precision": 0.0,
                    "recall": 0.0,
                    "True Positif": 0,
                    "False Positif": 3,
                    "False Negatif": 0,
                    "total real association": 0,
                },
            },
        }
    ],
}
